I derive simple non-local dynamic boundary conditions, suitable for modelling
of radiation emission from stacked Josephson junctions, and employ them for
analysis of flux-flow emission from intrinsic Josephson junctions in high-$T_c$
superconductors. It is shown that due to the lack of Lorenz contraction of
fluxons in stacked junctions, high quality geometrical resonances are
prerequisite for high power emission from the stack. This leads to a dual role
of the radiative impedance: on the one hand, small impedance increases the
efficiency of emission from the stack, on the other hand, enhanced radiative
losses reduce the quality factor of geometrical resonances, which may decrease
the total emission power. Therefore, the optimal conditions for the coherent
flux-flow oscillator are achieved when radiative losses are comparable to
resistive losses inside the stack.