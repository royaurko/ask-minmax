Based on the compactness of the moduli of non-collapsed Calabi-Yau spaces
with mild singularities, we set up a structure theory for polarized K\"ahler
Ricci flows with proper geometric bounds. Our theory is a generalization of the
structure theory of non-collapsed K\"ahler Einstein manifolds. As applications,
we prove the Hamilton-Tian conjecture and the partial-$C^0$-conjecture of Tian.