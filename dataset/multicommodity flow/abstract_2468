We propose a dynamical theory of market liquidity that predicts that the
average supply/demand profile is V-shaped and {\it vanishes} around the current
price. This result is generic, and only relies on mild assumptions about the
order flow and on the fact that prices are (to a first approximation)
diffusive. This naturally accounts for two striking stylized facts: first,
large metaorders have to be fragmented in order to be digested by the liquidity
funnel, leading to long-memory in the sign of the order flow. Second, the
anomalously small local liquidity induces a breakdown of linear response and a
diverging impact of small orders, explaining the "square-root" impact law, for
which we provide additional empirical support. Finally, we test our arguments
quantitatively using a numerical model of order flow based on the same minimal
ingredients.