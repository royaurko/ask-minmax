A new force balance model for the EFIT magnetohydrodynamic equilibrium
technique for tokamaks is presented which includes the full toroidal flow and
anisotropy changes to the Grad-Shafranov equation. The free functions are
poloidal flux functions and all non-linear contributions to the toroidal
current density are treated iteratively. The parallel heat flow approximation
chosen for the model is that parallel temperature is a flux function and that
both parallel and perpendicular pressures may be described using parallel and
perpendicular temperatures. This choice for the fluid thermodynamics has been
shown elsewhere to be the same as a guiding centre kinetic solution of the same
problem under the same assumptions. The model reduces identically to the static
and isotropic Grad-Shafranov equation in the appropriate limit as different
flux functions are set to zero. An analytical solution based on a modified
Soloviev solution for non-zero toroidal flow and anisotropy is also presented.
  The force balance model has been demonstrated in the code EFIT TENSOR, a
branch of the existing code EFIT++. Benchmark results for EFIT TENSOR are
presented and the more complicated force balance model is found to converge to
force balance similarly to the usual EFIT model and with comparable speed.