Context: The solution of the nonlocal thermodynamical equilibrium (non-LTE)
radiative transfer equation usually relies on stationary iterative methods,
which may falsely converge in some cases. Furthermore, these methods are often
unable to handle large-scale systems, such as molecular spectra emerging from,
for example, cool stellar atmospheres.
  Aims: Our objective is to develop a new method, which aims to circumvent
these problems, using nonstationary numerical techniques and taking advantage
of parallel computers.
  Methods: The technique we develop may be seen as a generalization of the
coupled escape probability method. It solves the statistical equilibrium
equations in all layers of a discretized model simultaneously. The numerical
scheme adopted is based on the generalized minimum residual method.
  Result:. The code has already been applied to the special case of the water
spectrum in a red supergiant stellar atmosphere. This demonstrates the fast
convergence of this method, and opens the way to a wide variety of
astrophysical problems.