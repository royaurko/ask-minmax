The spatial structure of populations is a key element in the understanding of
the large scale spreading of epidemics. Motivated by the recent empirical
evidence on the heterogeneous properties of transportation and commuting
patterns among urban areas, we present a thorough analysis of the behavior of
infectious diseases in metapopulation models characterized by heterogeneous
connectivity and mobility patterns. We derive the basic reaction-diffusion
equation describing the metapopulation system at the mechanistic level and
derive an early stage dynamics approximation for the subpopulation invasion
dynamics. The analytical description uses degree block variables that allows us
to take into account arbitrary degree distribution of the metapopulation
network. We show that along with the usual single population epidemic threshold
the metapopulation network exhibits a global threshold for the subpopulation
invasion. We find an explicit analytic expression for the invasion threshold
that determines the minimum number of individuals traveling among
subpopulations in order to have the infection of a macroscopic number of
subpopulations. The invasion threshold is a function of factors such as the
basic reproductive number, the infectious period and the mobility process and
it is found to decrease for increasing network heterogeneity. We provide
extensive mechanistic numerical Monte Carlo simulations that recover the
analytical finding in a wide range of metapopulation network connectivity
patterns. The results can be useful in the understanding of recent data driven
computational approaches to disease spreading in large transportation networks
and the effect of containment measures such as travel restrictions.