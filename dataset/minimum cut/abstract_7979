We present a modification of the $\Delta$SCF method of calculating energies
of excited states, in order to make it applicable to resonance calculations of
molecules adsorbed on metal surfaces, where the molecular orbitals are highly
hybridized. The $\Delta$SCF approximation is a density functional method
closely resembling standard density functional theory (DFT), the only
difference being that in $\Delta$SCF one or more electrons are placed in higher
lying Kohn-Sham orbitals, instead of placing all electrons in the lowest
possible orbitals as one does when calculating the ground state energy within
standard DFT. We extend the $\Delta$SCF method by allowing excited electrons to
occupy orbitals which are linear combinations of Kohn-Sham orbitals. With this
extra freedom it is possible to place charge locally on adsorbed molecules in
the calculations, such that resonance energies can be estimated. The method is
applied to N$_2$, CO and NO adsorbed on different metallic surfaces and
compared to ordinary $\Delta$SCF without our modification, spatially
constrained DFT and inverse-photoemission spectroscopy (IPES) measurements.
This comparison shows that the modified $\Delta$SCF method gives results in
close agreement with experiment, significantly closer than the comparable
methods. For N$_2$ adsorbed on ruthenium (0001) we map out a 2-dimensional part
of the potential energy surfaces in the ground state and the 2$\pi$-resonance.
Finally we compare the $\Delta$SCF approach on gas-phase N$_2$ and CO, to
higher accuracy methods. Excitation energies are approximated with accuracy
close to that of time-dependent density functional theory, and we see very good
agreement in the minimum shift of the potential energy surfaces in the excited
state compared to the ground state.