We improve the description of the evolution of the Sun's open and total
magnetic flux on time scales of years to millenia. In the model employed here
the evolution of the solar total and open magnetic flux is computed from the
flux emerging at the solar surface in the form of bipolar magnetic features,
which is related to the sunspot number cycle parameters and can be estimated
from historical records. Compared to earlier versions of the model in addition
to the long-lived open flux, now also a more rapidly decaying component of the
open flux is considered. The model parameters are constrained by comparing its
output with observations of the total surface magnetic flux and with a
reconstruction of the open magnetic flux based on the geomagnetic indexes. A
method to compute the Sun's total magnetic flux and the sunspot number during
the Holocene, starting from the open flux obtained from cosmogenic isotopes
records, is also presented. By considering separately a rapdly evolving and a
slowly evolving component of the open flux the model reproduces the Sun's open
flux, as reconstructed based on the aa-index, much better and a reasonable
description of the radial component of interplanetary magnetic field data are
obtained. The greatest improvement is in the reproduction of the cyclic
variation of the open flux, including the amplitudes of individual cycles.
Furthermore, we found that approximately 25% of the modeled open flux values
since the end of the Maunder Minimum are lower than the averaged value during
the current low minimum. The same proportion is observed in reconstructions of
the open flux during the Holocene based on cosmogenic isotopes, which suggests
that the present solar minimum conditions are below average, but not
exceptional in terms of the magnetic flux.