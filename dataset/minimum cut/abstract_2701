The minimum mass that a virialized gas cloud must have in order to be able to
cool in a Hubble time is computed, using a detailed treatment of the chemistry
of molecular hydrogen. With a simple model for halo profiles, we reduce the
problem to that of numerically integrating a system of chemical equations. The
results agree well with numerically expensive 3D simulations, and our approach
has the advantage of rapidly being able to explore large regions of parameter
space. The minimum baryonic mass M_b is found to be strongly redshift
dependent, dropping from 10^6 solar masses at z=15 to 5000 solar masses at
z=100 as molecular cooling becomes effective. For z>>100, M_b rises again, as
CMB photons inhibit H_2-formation through the H^- channel. Finally, for z>>200,
the H_2^+ channel for H_2-formation becomes effective, driving M_b down towards
10^3 solar masses. With a standard CDM power spectrum with sigma_8=0.7, this
implies that a fraction 10^{-3} of all baryons may have formed luminous objects
by z=30, which could be sufficient to reheat the universe.