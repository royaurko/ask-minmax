Microgrid (MG) is a promising component for future smart grid (SG)
deployment. The balance of supply and demand of electric energy is one of the
most important requirements of MG management. In this paper, we present a novel
framework for smart energy management based on the concept of
quality-of-service in electricity (QoSE). Specifically, the resident
electricity demand is classified into basic usage and quality usage. The basic
usage is always guaranteed by the MG, while the quality usage is controlled
based on the MG state. The microgrid control center (MGCC) aims to minimize the
MG operation cost and maintain the outage probability of quality usage, i.e.,
QoSE, below a target value, by scheduling electricity among renewable energy
resources, energy storage systems, and macrogrid. The problem is formulated as
a constrained stochastic programming problem. The Lyapunov optimization
technique is then applied to derive an adaptive electricity scheduling
algorithm by introducing the QoSE virtual queues and energy storage virtual
queues. The proposed algorithm is an online algorithm since it does not require
any statistics and future knowledge of the electricity supply, demand and price
processes. We derive several "hard" performance bounds for the proposed
algorithm, and evaluate its performance with trace-driven simulations. The
simulation results demonstrate the efficacy of the proposed electricity
scheduling algorithm.