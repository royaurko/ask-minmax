first calculating including calculating a similarity between each of a plurality of retrieval target images and a query image by using a layout feature amount, the layout feature amount being a feature amount related to layout obtained from the retrieval target images and the query image; ranking the retrieval target images in descending order of similarities calculated at the first calculating; dividing the retrieval target images that are ranked at the ranking into at least two groups in a predetermined number on a ranking basis; second calculating including calculating, for each group, a similarity between each of a plurality of retrieval target images in the group and the query image by using an image-property feature amount, the image-property feature amount being a feature amount related to properties other than the layout obtained from the retrieval target images and the query image; and ranking the retrieval target images in the group in descending order of similarities calculated at the second calculating. a first calculating unit that calculates a similarity between each of a plurality of retrieval target images and a query image by using a layout feature amount, the layout feature amount being a feature amount related to layout obtained from the retrieval target images and the query image; a first ranking unit that ranks the retrieval target images in descending order of similarities calculated by the first calculating unit; a dividing unit that divides the retrieval target images that are ranked by the first ranking unit into at least two groups in a predetermined number on a ranking basis; a second calculating unit that calculates, for each group, a similarity between each of a plurality of retrieval target images in the group and the query image by using an image-property feature amount, the image-property feature amount being a feature amount related to properties other than the layout obtained from the retrieval target images and the query image; and a second ranking unit that ranks the retrieval target images in the group in descending order of similarities calculated by the second calculating unit.