Due to the well-developed technology, the radio frequency identification (RFID) is widely used in all areas. For some applications, the RFID system simply worked as a memory card without security mechanism. However, in many applications, the RFID systems need security mechanism for authentication. In scenario such as e-passport, the RFID systems even need mechanism to protect userpsilas privacy. In 2004, Gao et al. proposed a RFID system for supply chain, and their system has security drawbacks. In 2007, Chen et al. proposed an improved mechanism to enhance the security. However, in this paper, we will show that Chen et al.'s protocol is not so secure as they claimed. Any adversary can masquerade as a legal user if he/she eavesdrops the transmitted message. We propose an improvement protocol to fix the flaws. The improvement protocol is secure with merits of privacy protection, resisting counterfeit attack and obtain mutual authentication.