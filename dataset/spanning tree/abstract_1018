We investigate the spins and shapes of over a million dark matter haloes
identified at z=0 in the Millennium simulation. Our sample spans halo masses
ranging from dwarf galaxies to rich galaxy clusters. The very large dynamic
range of this simulation enables the distribution of spins and shapes and their
variation with halo mass and environment to be characterised with unprecedented
precision. We compare results for haloes identified using different algorithms,
including a novel one based on the branches of the halo merger trees. We
investigate (and remove) biases in the estimate of angular momentum introduced
by both the algorithms themselves and by numerical effects. We find that for
this many objects, the traditional lognormal function is no longer an adequate
description of the distribution of the dimensionless spin parameter lambda, and
we provide a different function that gives a better fit. The variation of spin
with halo mass is weak but detectable, although the trend depends strongly on
the halo definition used. The haloes exhibit a range of shapes, with a
preference for prolateness over oblateness. More massive haloes tend to be less
spherical and more prolate. We find that the more spherical haloes have spin in
the median, and those closest to spherical have a spin independent of mass. The
most massive have a spin independent of shape. The majority of haloes have
their angular momentum vector aligned with their minor axis and perpendicular
to their major axis. We find that higher tend to be more clustered, with a
stronger effect for more massive haloes. (abridged)