The classical matrix-tree theorem relates the determinant of the
combinatorial Laplacian on a graph to the number of spanning trees. We
generalize this result to Laplacians on one- and two-dimensional vector
bundles, giving a combinatorial interpretation of their determinants in terms
of so-called cycle rooted spanning forests (CRSFs). We construct natural
measures on CRSFs for which the edges form a determinantal process. This theory
gives a natural generalization of the spanning tree process adapted to graphs
embedded on surfaces. We give a number of other applications, for example, we
compute the probability that a loop-erased random walk on a planar graph
between two vertices on the outer boundary passes left of two given faces. This
probability cannot be computed using the standard Laplacian alone.