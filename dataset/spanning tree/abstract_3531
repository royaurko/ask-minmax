A family of orthonormal bases of ultrametric wavelets in the space of
quadratically integrable with respect to arbitrary measure functions on general
(up to some topological restrictions) ultrametric space is introduced.
  Pseudodifferential operators (PDO) on the ultrametric space are investigated.
We prove that these operators are diagonal in the introduced bases of
ultrametric wavelets and compute the corresponding eigenvalues.
  Duality between ultrametric spaces and directed trees is discussed. In
particular, a new way of construction of ultrametric spaces by completion of
directed trees is proposed.