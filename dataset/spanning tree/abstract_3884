In this paper, based on the theory of rooted trees and B-series, we propose
the concrete formulas of the substitution law for the trees of order =5. With
the help of the new substitution law, we derive a B-series integrator extending
the averaged vector field (AVF) method to high order. The new integrator turns
out to be of order six and exactly preserves energy for Hamiltonian systems.
Numerical experiments are presented to demonstrate the accuracy and the
energy-preserving property of the sixth order AVF method.