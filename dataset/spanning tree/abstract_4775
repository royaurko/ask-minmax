We present a new method for calculating the merger history of matter halos in
hierarchical clustering cosmologies. The linear density field is smoothed on a
range of scales, these are then ordered in decreasing density and a merger tree
constructed. The method is similar in many respects to the block model of Cole
\& Kaiser but has a number of advantages: (i) it retains information about the
spatial correlations between halos, (ii) it uses a series of overlapping grids
and is thereby much better at finding rare, high-mass halos, (iii) it is not
limited to halos whose mass ratios are powers of two, and (iv) it is based on
an actual realization of the density field and so can be tested against N-body
simulations. The major disadvantages are (i) the minimum halo mass is eight
times the unit cell with a corresponding loss of dynamic range, and (ii)
occasionally the relative location of halos in the tree does not reflect the
correct ordering of their collapse times, as computed from the mean halo
density. We show that our model exhibits the required scaling behaviour when
tested on power-law spectra of density perturbations, but that it predicts far
more massive halos than does the Press-Schechter formalism for flat spectra. We
suggest reasons why this should be so.