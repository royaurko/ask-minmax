We prove the equivalence between a relative bottleneck property and being
quasi-isometric to a tree-graded space. As a consequence, we prove that the
quasi-trees of spaces defined axiomatically by Bestvina, Bromberg and Fujiwara
are quasi tree-graded. Using this we prove that mapping class groups
quasi-isometrically embed into a finite product of simplicial trees. In
particular, these groups have finite Assouad-Nagata dimension, direct
embeddings exhibiting $\ell^p$ compression exponent 1 for all $p\geq 1$ and
they quasi-isometrically embed into $\ell^1(\N)$. We deduce similar
consequences for relatively hyperbolic groups whose parabolic subgroups satisfy
such conditions.