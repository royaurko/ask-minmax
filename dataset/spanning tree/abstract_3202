The reconstruction of phylogenetic trees based on viral genetic sequence data
sequentially sampled from an epidemic provides estimates of the past
transmission dynamics, by fitting epidemiological models to these trees. To our
knowledge, none of the epidemiological models currently used in phylogenetics
can account for recovery rates and sampling rates dependent on the time elapsed
since transmission.
  Here we introduce an epidemiological model where infectives leave the
epidemic, either by recovery or sampling, after some random time which may
follow an arbitrary distribution.
  We derive an expression for the likelihood of the phylogenetic tree of
sampled infectives under our general epidemiological model. The analytic
concept developed in this paper will facilitate inference of past
epidemiological dynamics and provide an analytical framework for performing
very efficient simulations of phylogenetic trees under our model. The main idea
of our analytic study is that the non-Markovian epidemiological model giving
rise to phylogenetic trees growing vertically as time goes by, can be
represented by a Markovian "coalescent point process" growing horizontally by
the sequential addition of pairs of coalescence and sampling times.
  As examples, we discuss two special cases of our general model, namely an
application to influenza and an application to HIV. Though phrased in
epidemiological terms, our framework can also be used for instance to fit
macroevolutionary models to phylogenies of extant and extinct species,
accounting for general species lifetime distributions.