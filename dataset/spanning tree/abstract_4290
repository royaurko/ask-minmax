A recurring theme in the least squares approach to phylogenetics has been the
discovery of elegant combinatorial formulas for the least squares estimates of
edge lengths. These formulas have proved useful for the development of
efficient algorithms, and have also been important for understanding
connections among popular phylogeny algorithms. For example, the selection
criterion of the neighbor-joining algorithm is now understood in terms of the
combinatorial formulas of Pauplin for estimating tree length.
  We highlight a phylogenetically desirable property that weighted least
squares methods should satisfy, and provide a complete characterization of
methods that satisfy the property. The necessary and sufficient condition is a
multiplicative four point condition that the the variance matrix needs to
satisfy. The proof is based on the observation that the Lagrange multipliers in
the proof of the Gauss--Markov theorem are tree-additive. Our results
generalize and complete previous work on ordinary least squares, balanced
minimum evolution and the taxon weighted variance model. They also provide a
time optimal algorithm for computation.