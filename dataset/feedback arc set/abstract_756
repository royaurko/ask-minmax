We present a dynamical model of supernova feedback which follows the
evolution of pressurised bubbles driven by supernovae in a multi-phase
interstellar medium (ISM). The bubbles are followed until the point of
break-out into the halo, starting from an initial adiabatic phase to a
radiative phase. We show that a key property which sets the fate of bubbles in
the ISM is the gas surface density, through the work done by the expansion of
bubbles and its role in setting the gas scaleheight. The multi-phase
description of the ISM is essential, and neglecting it leads to order of
magnitude differences in the predicted outflow rates. We compare our predicted
mass loading and outflow velocities to observations of local and high-redshift
galaxies and find good agreement over a wide range of stellar masses and
velocities. With the aim of analysing the dependence of the mass loading of the
outflow, beta (i.e. the ratio between the outflow and star formation rates), on
galaxy properties, we embed our model in the galaxy formation simulation,
GALFORM, set in the LCDM framework. We find that a dependence of beta solely on
the circular velocity, as is widely assumed in the literature, is actually a
poor description of the outflow rate, as large variations with redshift and
galaxy properties are obtained. Moreover, we find that below a circular
velocity of 80km/s the mass loading saturates. A more fundamental relation is
that between beta and the gas scaleheight of the disk, hg, and the gas
fraction, fgas, as beta hg^(1.1) fgas^(0.4), or the gas surface density,
\Sigma_g, and the gas fraction, as beta \Sigma_g^(-0.6) fgas^(0.8). We find
that using the new mass loading model leads to a shallower faint-end slope in
the predicted optical and near-IR galaxy luminosity functions.