The original formulation of BEAMS - Bayesian Estimation Applied to Multiple
Species - showed how to use a dataset contaminated by points of multiple
underlying types to perform unbiased parameter estimation. An example is
cosmological parameter estimation from a photometric supernova sample
contaminated by unknown Type Ibc and II supernovae. Where other methods require
data cuts to increase purity, BEAMS uses all of the data points in conjunction
with their probabilities of being each type. Here we extend the BEAMS formalism
to allow for correlations between the data and the type probabilities of the
objects as can occur in realistic cases. We show with simple simulations that
this extension can be crucial, providing a 50% reduction in parameter
estimation variance when such correlations do exist. We then go on to perform
tests to quantify the importance of the type probabilities, one of which
illustrates the effect of biasing the probabilities in various ways. Finally, a
general presentation of the selection bias problem is given, and discussed in
the context of future photometric supernova surveys and BEAMS, which lead to
specific recommendations for future supernova surveys.