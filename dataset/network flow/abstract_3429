We present a detailed analytical study of the $A+A\to\emptyset$
diffusion-annihilation process in complex networks. By means of microscopic
arguments, we derive a set of rate equations for the density of $A$ particles
in vertices of a given degree, valid for any generic degree distribution, and
which we solve for uncorrelated networks. For homogeneous networks (with
bounded fluctuations), we recover the standard mean-field solution, i.e. a
particle density decreasing as the inverse of time. For heterogeneous
(scale-free networks) in the infinite network size limit, we obtain instead a
density decreasing as a power-law, with an exponent depending on the degree
distribution. We also analyze the role of finite size effects, showing that any
finite scale-free network leads to the mean-field behavior, with a prefactor
depending on the network size. We check our analytical predictions with
extensive numerical simulations on homogeneous networks with Poisson degree
distribution and scale-free networks with different degree exponents.