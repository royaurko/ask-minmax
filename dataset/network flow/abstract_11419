In this paper, we consider a three node, two-way relay system with digital
network coding over static channels where all link gains are assumed to be
constant during transmission. The aim is to minimize total energy consumption
while ensuring queue stability at all nodes, for a given pair of random packet
arrival rates. Specifically, we allow for a set of transmission modes and solve
for the optimal fraction of resources allocated to each mode, including
multiaccess uplink transmission mode and network coding broadcasting mode. In
addition, for the downlink, we find the condition to determine whether
superposition coding with excess data over the better link and network coded
data for both users is energy efficient and the corresponding optimization is
formulated and solved. To tackle the queue evolution in this network, we
present a detailed analysis of the queues at each node using a random
scheduling method that closely approximates the theoretical design, through a
two-dimensional Markov chain model.