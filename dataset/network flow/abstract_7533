This is a technical paper, which is a continuation of math.DG/0211159. Here
we construct Ricci flow with surgeries and verify most of the assertions, made
in section 13 of that e-print; the exceptions are (1) the statement that
manifolds that can collapse with local lower bound on sectional curvature are
graph manifolds - this is deferred to a separate paper, since the proof has
nothing to do with the Ricci flow, and (2) the claim on the lower bound for the
volume of maximal horns and the smoothness of solutions from some time on,
which turned out to be unjustified and, on the other hand, irrelevant for the
other conclusions.