We consider a generalized multi-hop MIMO amplify-and-forward (AF) relay
network with multiple sources/destinations and arbitrarily number of relays. We
establish two dualities and the corresponding dual transformations between such
a network and its dual, respectively under single network linear constraint and
per-hop linear constraint. The result is a generalization of the previous
dualities under different special cases and is proved using new techniques
which reveal more insight on the duality structure that can be exploited to
optimize MIMO precoders. A unified optimization framework is proposed to find a
stationary point for an important class of non-convex optimization problems of
AF relay networks based on a local Lagrange dual method, where the primal
algorithm only finds a stationary point for the inner loop problem of
maximizing the Lagrangian w.r.t. the primal variables. The input covariance
matrices are shown to satisfy a polite water-filling structure at a stationary
point of the inner loop problem. The duality and polite water-filling are
exploited to design fast primal algorithms. Compared to the existing
algorithms, the proposed optimization framework with duality-based primal
algorithms can be used to solve more general problems with lower computation
cost.