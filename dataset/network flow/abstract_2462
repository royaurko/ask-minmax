Futures contracts are an important tool to mitigate market risk and
counterparty credit risk. In futures markets these contracts can be traded with
varying expiration dates and underlyings. A common hedging strategy is to roll
positions forward into the next expiration date, however this strategy comes
with significant rollover risk both in terms of the time spread risk but also
operational risk. To address the latter, exchanges started to offer so-called
futures contract combinations, which allow the traders for swapping two futures
contracts with different expiration dates (time spread trade) or for swapping
two futures contracts with different underlyings (inter-product spread trade).
In theory, the price is in both cases the difference of the two involved
futures contracts. However, in particular in the opening auctions price
inefficiencies often occur due to suboptimal clearing, leading to potential
arbitrage opportunities.
  We present a minimum cost flow formulation of the futures opening auction
problem that guarantees consistent prices. The core ideas are to model orders
as arcs in a network, to enforce the equilibrium conditions with the help of
two hierarchical objectives, and to combine these objectives into a single
weighted objective while preserving the price information of dual optimal
solutions. The resulting optimization problem can be solved in polynomial time
and computational tests establish an empirical performance suitable for
production environments.