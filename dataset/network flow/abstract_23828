Modularity was introduced as a measure of goodness for the community
structure induced by a partition of the set of vertices in a graph. Then, it
also became an objective function used to find good partitions, with high
success. Nevertheless, some works have shown a scaling limit and certain
instabilities when finding communities with this criterion. Modularity has been
studied proposing several formalisms, as hamiltonians in a Potts model or
laplacians in spectral partitioning. In this paper we present a new
probabilistic formalism to analyze modularity, and from it we derive an
algorithm based on weakly optimal partitions. This algorithm obtains good
quality partitions and also scales to large graphs.