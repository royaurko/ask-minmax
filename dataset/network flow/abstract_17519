Dynamical systems that exhibit diverse behaviors can rarely be completely
understood using a single approach. However, by identifying coherent structures
in their state spaces, i.e., regions of uniform and simpler behavior, we could
hope to study each of the structures separately and then form the understanding
of the system as a whole. The method we present in this paper uses trajectory
averages of scalar functions on the state space to: (a) identify invariant sets
in the state space, (b) form coherent structures by aggregating invariant sets
that are similar across multiple spatial scales. First, we construct the
ergodic quotient, the object obtained by mapping trajectories to the space of
trajectory averages of a function basis on the state space. Second, we endow
the ergodic quotient with a metric structure that successfully captures how
similar the invariant sets are in the state space. Finally, we parametrize the
ergodic quotient using intrinsic diffusion modes on it. By segmenting the
ergodic quotient based on the diffusion modes, we extract coherent features in
the state space of the dynamical system. The algorithm is validated by
analyzing the Arnold-Beltrami-Childress flow, which was the test-bed for
alternative approaches: the Ulam's approximation of the transfer operator and
the computation of Lagrangian Coherent Structures. Furthermore, we explain how
the method extends the Poincar\'e map analysis for periodic flows. As a
demonstration, we apply the method to a periodically-driven three-dimensional
Hill's vortex flow, discovering unknown coherent structures in its state space.
In the end, we discuss differences between the ergodic quotient and
alternatives, propose a generalization to analysis of (quasi-)periodic
structures, and lay out future research directions.