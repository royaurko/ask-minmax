We introduce collision free layerings as a powerful way to structure radio
networks. These layerings can replace hard-to-compute BFS-trees in many
contexts while having an efficient randomized distributed construction. We
demonstrate their versatility by using them to provide near optimal distributed
algorithms for several multi-message communication primitives.
  Designing efficient communication primitives for radio networks has a rich
history that began 25 years ago when Bar-Yehuda et al. introduced fast
randomized algorithms for broadcasting and for constructing BFS-trees. Their
BFS-tree construction time was $O(D \log^2 n)$ rounds, where $D$ is the network
diameter and $n$ is the number of nodes. Since then, the complexity of a
broadcast has been resolved to be $T_{BC} = \Theta(D \log \frac{n}{D} + \log^2
n)$ rounds. On the other hand, BFS-trees have been used as a crucial building
block for many communication primitives and their construction time remained a
bottleneck for these primitives.
  We introduce collision free layerings that can be used in place of BFS-trees
and we give a randomized construction of these layerings that runs in nearly
broadcast time, that is, w.h.p. in $T_{Lay} = O(D \log \frac{n}{D} +
\log^{2+\epsilon} n)$ rounds for any constant $\epsilon>0$. We then use these
layerings to obtain: (1) A randomized algorithm for gathering $k$ messages
running w.h.p. in $O(T_{Lay} + k)$ rounds. (2) A randomized $k$-message
broadcast algorithm running w.h.p. in $O(T_{Lay} + k \log n)$ rounds. These
algorithms are optimal up to the small difference in the additive
poly-logarithmic term between $T_{BC}$ and $T_{Lay}$. Moreover, they imply the
first optimal $O(n \log n)$ round randomized gossip algorithm.