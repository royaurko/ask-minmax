We present a fast spectral algorithm for community detection in complex
networks. Our method searches for the partition with the maximum value of the
modularity via the interplay of several refinement steps that include both
agglomeration and division. We validate the accuracy of the algorithm by
applying it to several real-world benchmark networks. On all these, our
algorithm performs as well or better than any other known polynomial scheme.
This allows us to extensively study the modularity distribution in ensembles of
Erd\H{o}s-R\'enyi networks, producing theoretical predictions for means and
variances inclusive of finite-size corrections. Our work provides a way to
accurately estimate the effect size of modularity, providing a $z$-score
measure of it and enabling a more informative comparison of networks with
different numbers of nodes and links.