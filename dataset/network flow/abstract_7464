We introduce knowledge flow analysis, a simple and flexible formalism for
checking cryptographic protocols. Knowledge flows provide a uniform language
for expressing the actions of principals, assump- tions about intruders, and
the properties of cryptographic primitives. Our approach enables a generalized
two-phase analysis: we extend the two-phase theory by identifying the necessary
and sufficient proper- ties of a broad class of cryptographic primitives for
which the theory holds. We also contribute a library of standard primitives and
show that they satisfy our criteria.