This work presents a generalization of the Kraynik-Reinelt (KR) boundary
conditions for nonequilibrium molecular dynamics simulations. In the simulation
of steady, homogeneous flows with periodic boundary conditions, the simulation
box moves with the flow, and it is possible for particle replicas to become
arbitrarily close, causing a breakdown in the simulation. The KR boundary
conditions avoid this problem for planar elongational flow and general planar
mixed flow [J. Chem. Phys 133, 14116 (2010)] through careful choice of the
initial simulation box and by periodically remapping the simulation box in a
way that conserves replica locations. In this work, the ideas are extended to a
large class of three dimensional flows by using multiple remappings for the
simulation box. The simulation box geometry is no longer time-periodic (which
was shown to be impossible for uniaxial and biaxial stretching flows in the
original work by Kraynik and Reinelt [Int. J. Multiphase Flow 18, 1045
(1992)]). The presented algorithm applies to all flows with nondefective flow
matrices, and in particular, to uniaxial and biaxial flows.