We study the long-time behavior of the Kahler-Ricci flow on compact Kahler
manifolds. We give an almost complete classification of the singularity type of
the flow at infinity, depending only on the underlying complex structure. If
the manifold is of intermediate Kodaira dimension and has semiample canonical
bundle, so that it is fibered by Calabi-Yau varieties, we show that parabolic
rescalings around any point on a smooth fiber converge smoothly to a unique
limit, which is the product of a Ricci-flat metric on the fiber and of a flat
metric on Euclidean space. An analogous result holds for collapsing limits of
Ricci-flat Kahler metrics.