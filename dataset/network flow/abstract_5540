This paper presents an algorithm to automatically design two-level fat-tree
networks, such as ones widely used in large-scale data centres and cluster
supercomputers. The two levels may each use a different type of switches from
design database to achieve an optimal network structure. Links between layers
can run in bundles to simplify cabling. Several sample network designs are
examined and their technical and economic characteristics are discussed.
  The characteristic feature of our approach is that real life equipment prices
and values of technical characteristics are used. This allows to select an
optimal combination of hardware to build the network (including semi-populated
configurations of modular switches) and accurately estimate the cost of this
network. We also show how technical characteristics of the network can be
derived from its per-port metrics and suggest heuristics for equipment
placement.
  The algorithm is useful as a part of a bigger design procedure that selects
optimal hardware of cluster supercomputer as a whole. Therefore the article is
focused on the use of fat-trees for high-performance computing, although the
results are valid for any type of data centres.