Recent progress in theoretical modeling of a sunspot is reviewed. The
observed properties of umbral dots are well reproduced by realistic simulations
of magnetoconvection in a vertical, monolithic magnetic field. To understand
the penumbra, it is useful to distinguish between the inner penumbra, dominated
by bright filaments containing slender dark cores, and the outer penumbra, made
up of dark and bright filaments of comparable width with corresponding magnetic
fields differing in inclination by some 30 degrees and strong Evershed flows in
the dark filaments along nearly horizontal or downward-plunging magnetic
fields. The role of magnetic flux pumping in submerging magnetic flux in the
outer penumbra is examined through numerical experiments, and different
geometric models of the penumbral magnetic field are discussed in the light of
high-resolution observations. Recent, realistic numerical MHD simulations of an
entire sunspot have succeeded in reproducing the salient features of the
convective pattern in the umbra and the inner penumbra. The siphon-flow
mechanism still provides the best explanation of the Evershed flow,
particularly in the outer penumbra where it often consists of cool, supersonic
downflows.