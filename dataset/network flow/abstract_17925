We consider a generalized processing system having several queues, where the
available service rate combinations are fluctuating over time due to
reliability and availability variations. The objective is to allocate the
available resources, and corresponding service rates, in response to both
workload and service capacity considerations, in order to maintain the long
term stability of the system. The service configurations are completely
arbitrary, including negative service rates which represent forwarding and
service-induced cross traffic. We employ a trace-based trajectory asymptotic
technique, which requires minimal assumptions about the arrival dynamics of the
system.
  We prove that cone schedules, which leverage the geometry of the queueing
dynamics, maximize the system throughput for a broad class of processing
systems, even under adversarial arrival processes. We study the impact of
fluctuating service availability, where resources are available only some of
the time, and the schedule must dynamically respond to the changing available
service rates, establishing both the capacity of such systems and the class of
schedules which will stabilize the system at full capacity. The rich geometry
of the system dynamics leads to important insights for stability, performance
and scalability, and substantially generalizes previous findings.
  The processing system studied here models a broad variety of computer,
communication and service networks, including varying channel conditions and
cross-traffic in wireless networking, and call centers with fluctuating
capacity. The findings have implications for bandwidth and processor allocation
in communication networks and workforce scheduling in congested call centers.