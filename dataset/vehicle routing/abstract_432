Password: This paper considers an extension of a vehicle routing problem with backhauls (VRPB). In this problem, a set of costumers are divided in two subsets consisting of linehaul and backhaul costumers. Each linehaul costumer requires delivering its demands from the depot. In addition, a specified quantity of products should be picked up from the backhaul nodes to the depot. The VRPB is a well-known NP-hard problem in strong sense and a number of algorithms are proposed for approximate solutions of such a hard problem. In this paper, a memetic algorithm (MA) is proposed which uses different local search algorithms to solve the VRPB. Exploiting power of memetic algorithm, inter and intra-route node exchanges are used as a part of this evolutionary algorithm. Extensive computational tests on some instances taken from the literature reveal the effectiveness of the proposed algorithm. Keywords Vehicle Routing Problem with Backhauls ; Memetic algorithm ; Local search 1. Introduction This paper considers an extension of a vehicle routing problem with backhauls (VRPB). In this problem, a set of costumers are divided in two subsets consisting of linehaul and backhaul costumers. Each linehaul costumer requires delivering its demands from the depot. In addition, a specified quantity of products should be picked up from the backhaul nodes to the depot. A good example of this costumer set can be the grocery industry. An instance of this costumer partitioning is represented by the grocery industries. In this case, supermarkets and shops are the linehaul nodes and grocery suppliers are the backhaul nodes. In recent years, it is discovered that a great amount of savings have been achieved with combining the pickup/delivery context and exactly by visiting backhaul costumer along the distribution route. For example, the Interstate Commerce Commission estimated to save $160 million each year in USA grocery industries due to the introduction of backhauling [1] . More precisely, the VRPB can be defined as a problem of determining a set of vehicle routes visiting all costumers subject to the constraints as follows: (i) each vehicle performs just one route; (ii) for each route, the total load assigns to linehaul and backhaul node, in which should not separately exceed the vehicle capacity; (iii) one each route, backhaul nodes should be visited after all linehaul routes; and (iv) the total transportation cost should be minimized. The third condition (i.e., precedence constraint) generally puts here by the fact that in many applications, linehaul costumers have higher service priority than backhauls. The model and algorithm presented here consider the heterogeneous fleet and associated networks can be symmetric or asymmetric. In the heterogeneous fleet, different type of vehicle with dissimilar capacities may be introduced. More over in symmetric networks, the distance between two nodes is same in two directions, whereas in asymmetric network this assumption does not hold. The VRPB is NP-hard in strong sense, since it generalizes the capacitated VRP arising when there is no backhaul node available. 2. Relevant literature All previous researches from the literature have been considered only the homogeneous fleet version of the VRP. Toth and Vigo [2] developed a branch-and-bound algorithm in which a lower bound on the optimal solution is derived from a Lagrangean relaxation of some constraints of their linear programming (LP) formulation. Iteratively, the Lagrangean relaxation bound is further strengthened by adding valid inequalities in a cutting plane fashion. Yano et al. [3] developed a set covering based on the exact algorithm for a practical application in quality stores industry of the VRPB. In this application, each vehicle cannot deliver to (or collect from) more than a few customers. Mingozzi et al. [4] presented another LP formulation of the problem. They generated bounds by combining different heuristic procedures. An upper bound is obtained from the dual of their LP-relaxation and an exact branch-and-bound algorithm is developed based on the proposed lower and upper bound procedures. Deif and Bodin [5] proposed a heuristic algorithm, which is called DB hereafter, is based on the Clarke–Wright VRP heuristic [6] . The Clarke–Wright algorithm starts with an infeasible solution where each node visited by a separate route. Routes are then iteratively combined by regarding the “saving” in terms of routing cost that can be achieved by serving two nodes in the same route rather than putting each one in the route. Deif and Bodin [5] experimentally showed that VRPB best results are obtained by delaying the insertion of backhaul nodes. They put a penalty for arcs connecting linehaul nodes to backhaul nodes. The Clarke–Wright algorithm and hence the DB algorithm do not control the number of vehicles in the final solution and certainly this solution may need more than K routes and may be infeasible. Deif and Bodin tested their algorithm on randomly generated instances with 100–300 vertices with a backhaul percentage between 10% and 50%. They tested several problems and found out the best result obtained by problems with backhaul percentage between 20% and 50%. Different extensions of the DB algorithm are proposed by Casco et al. [7] . Golden et al. [1] also dealt with the VRPB without precedence constraint and they proposed a Clarke–Wright based algorithm. Goetschalckx and Jacobs [8] proposed an algorithm, which is called SF hereafter, for VRPB with the Euclidean cost matrix. The approach is based on space filling curves. In their work linehaul and backhaul nodes are separately transformed from points in the plan to point along a line. Two sequences of nodes are then partitioned to create a feasible solution of only one type. Then, the nearest backhaul route is merged in the specified linehaul route. In addition, this approach algorithm does not guarantee the number of vehicles that do not exceed K routes. Goeschalckx and Jacobs [8] tested DB and SF algorithms on 57 Euclidean instances with 25–150 vertices, 20–50% of which are backhauls. The result presented in their paper shows that DB solutions are generally better than SF but the SF algorithm is faster for large problems. Later Goestschalckz and Jachobs [9] presented a heuristics, which is called LHBH, for the Euclidean version of the VRP. Their algorithm was based on the extension of Fisher and Jaikumar for the general VRP, in which initially a partial solution made up of K route primitives is generated by determining k seed radials from the solution of the capacitated location–allocation problem. Then, for each such radial a route primitive is determined by selecting nodes located near the radial. Then, the sequencing procedure arranges the linehaul node according to their distance to the depot increases and the backhaul node due to their distance to the depot decreases. Then, the sequenced nodes are clustered in K routes according to vehicles’ capacities by solving the generalized assignment problem for them. Ultimately, the routes can be determined due to a modified insertion heuristic for the TSP and a post-optimization exchange procedure. Comparison of experiments on Euclidean problem instances showed that the LHBH outperforms the SF algorithm. Toth and Vigo [10] developed a cluster-first route-second heuristic based on the K -tree approach for the VRP. Their heuristic was named TV starting possibly with infeasible initial solutions which are obtained by solving a Lagrangean relaxation of the VRPB developed in [2] . Then, it gradually tries to construct a final set of feasible routes by using some local shifts and exchanges of customers between vehicle routes with the well-known 2-Opt and 3-Opt local improvement procedures. Furthermore, Toth and Vigo [11] implemented an improved version of the above heuristic (i.e., TV) to the symmetric and asymmetric VRPB. The TV heuristic algorithm produces very competitive results in the literature for this problem. On the heuristic side, few metaheuristic techniques have been proposed. Potvin et al. [12] designed a genetic algorithm to identify an ordering of customers that produces good routes. Tavakkoli-Moghaddam et al. [13] proposed en efficient metaheuristic method based on simulated annealing (SA) to solve a new mixed-integer linear model of a capacitated vehicle routing problem (CVRP) with split services and heterogeneous fleet. The proposed model was to minimize the fleet cost and total distance traveled in order to serve all given customers by using the maximum capacity and minimum number of vehicles. Duhamel et al. [14] designated a tabu search method for the VRP with backhaul and time windows (VRPBTW) as well as customer precedence. First, a feasible solution is constructed by an adapted version of Solomon insertion heuristic. Then, tabu search and local search and improvement algorithms are used to improve the solution. 3. Mathematical model In contrast to the previous researches, in this paper a heterogeneous VRPB model is presented. The proposed model considers different types of vehicles in the fleet in terms of the capacity and transportation cost. A mixed-integer programming (MIP) formulation of the problem is presented below. 3.1. Notation cost of moving from node i to node j using vehicle k n number of linehaul nodes m number of backhaul nodes M number of vehicles Q k capacity of vehicle k f i backhaul demand of node i d i linehaul demand of node i 3.2. Decision variable