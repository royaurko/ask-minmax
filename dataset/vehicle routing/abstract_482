Password: The advance of communication and information technologies based on satellite and wireless networks have allowed transportation companies to benefit from real-time information for dynamic vehicle routing with time windows. During daily operations, we consider the case in which customers can place requests such that their demand and location are stochastic variables. The time windows at customer locations can be violated although lateness costs are incurred. The objective is to define a set of vehicle routes which are dynamically updated to accommodate new customers in order to maximize the expected profit. This is the difference between the total revenue and the sum of lateness costs and costs associated with the total distance traveled. The solution approach makes use of a new constructive heuristic that scatters vehicles in the service area and an adaptive granular local search procedure. The strategies of letting a vehicle wait, positioning a vehicle in a region where customers are likely to appear, and diverting a vehicle away from its current destination are integrated within a granular local search heuristic. The performance of the proposed approach is assessed in test problems based on real-life Brazilian transportation companies. Keywords Dynamic vehicle routing ; Adaptive local search ; Heuristics 1. Introduction Affordable operating costs of global positioning systems and the advance of satellite-based communications technologies, in particular cellular phone networks, are providing Brazilian transportation companies with the ability to dynamically serve customers in order to collect orders within a few hours, or minutes, after the request has been received. A field research with three of the most important transportation companies of the metropolitan area of São Paulo, with a fleet size ranging from 200 to 600 vehicles, revealed that: • All three companies have real-time information about vehicle position, for example, each employee of the Vehicle Tracking and Communication Department (VTCD) is able to monitor the positioning of about 50 vehicles with an error of less than 200 m. • The VTCD is able to rapidly communicate with drivers and to monitor and control vehicle operations such as text message and voice communication, door unlocking when the vehicle is near the destination, setting and unsetting of vehicle alarm, automatic notification of vehicle moving away from its route, alarm triggering if the driver door is opened within an unauthorized region, digital images of the driver cabin every 10 seconds and notification if the vehicle speed is higher than a predetermined speed. The first motivation to invest in this technology is to protect the driver and the company from robbery. The gains are higher rates of recovered goods and discounts on insurance policies. In addition, another benefit is the possibility to dynamically modify vehicle routes. Based on a real-world case of one of the companies, this paper considers a dynamic vehicle routing problem (DVRP), which is one of the many variations of the standard vehicle routing problem (see [27] for an overview). In a dynamic setting, customers can place orders at any time during the day and information needed to solve the problem is revealed concurrently with the execution of the solution, thus implying that parts of the problem must be solved and re-solved several times. Granular local search is a heuristic with a reduced neighborhood based on a candidate-list strategy that was proposed by Toth and Vigo [27] for solving the standard vehicle routing problem. We develop an adaptive granular local search heuristic that adjusts the size of the search space according to the short time that is available for the optimization method. In our problem, the number of new customers to be served early in the day by a transportation company is much greater than in the middle to late afternoon. Thus, it is desirable to have an optimization method that is able to produce a fast response when the rate of new requests is high, and that spends more time searching for high-quality solutions when this rate is low. We also consider the strategies of letting a vehicle wait at suitable waiting places, positioning a vehicle in a region where customers are likely to appear and diverting a vehicle away from its current destination in response to a new customer request. Such strategies are integrated with the adaptive granular local search in order to obtain better solutions. The proposed heuristic procedure is compared to the best insertion and nearest neighbor heuristics. We also suggest a new constructive heuristic with the aim of scattering a given number of vehicles at the beginning of the day. The remainder of the paper is organized as follows. Section 2 describes the problem, and a review of related work is presented in Section 3 . The proposed constructive heuristic is detailed in Section 4 . Section 5 presents the granular local search and how it was adapted and applied to the DVRP. The simulation of a real-time environment for the computational tests is explained in Section 6 . Section 7 describes the waiting, positioning and diversion strategies that are combined with the granular local search heuristic and other heuristics. Computational tests are reported in Section 8 , and conclusions and future work are presented in Section 9 . 2. Problem description Each customer i has a demand q i < C and provides a revenue of r i monetary units, i ∈ N 1 ∪ N 2 . The travel time between customers i and j is denoted t ij . The service time at customer i lasts s i units of time and should begin at time b i within a time window defined by the earliest start time e i and the latest start time l i . If the vehicle arrives at customer i before e i , then it is subject to a waiting time. The service may start after l i , but a lateness penalty of p i units of cost per unit of late time is incurred. The transportation company puts an effort to serve all customers i ∈ N 1 before noon. Thus, for all i ∈ N 1 , e i = a i =0 and l i =12 am. For customers i ∈ N 2 , e i = a i , i.e., a service may begin as soon as the order has arrived. Also, there is a company policy that enforces that customers i ∈ N 2 with a i ⩽2 pm must be served in the same day. Therefore, these customers are also considered priority customers. Customers i ∈ N 2 with a i >2 pm are scheduled for the following day and are called non-priority customers. Eventually, non-priority customers may be served the same day, if feasible. The number m of available vehicles is determined from the historical daily average location and demand of customers. If during a period of days more than m vehicles are needed then the company hires additional vehicles from small companies. The dispatching of vehicles follows a simple policy. At the beginning of the day, the number of required vehicles and the routes are determined in order to serve the known customers that made a request in the previous day. As such customers should be served before noon, the designated vehicles are, in general, not able to serve new customers. In this case, the company dispatches a new vehicle to serve a new customer request. Additional vehicles are dispatched according to the routing and scheduling of the current planned routes. Another policy feature is that vehicles can be diverted from the planned routes. The diversion decision is sent via radio to the driver and 5 minutes are allowed to change the course and start the new route. All vehicles must return to the depot before 5 pm, which represents a shift of 9 hours if starting at 8 am. Drivers are granted a 1 hour lunch break between 11 am and 2 pm. A vehicle has a fixed cost of f monetary units per day and a variable cost of c monetary units per kilometer traveled. The calculation of these figures is based on vehicle acquisition costs and depreciation, maintenance, insurance, driver's salary and other expenses. In this work we assume that the company is operating with less than the average number of requests and thus its fleet of m vehicles is sufficient, and no renting is considered. This assumption represents a low demand scenario and is only considered in this work to simplify the problem. For a complete simulation of the real problem, one should include the decision of renting additional vehicles when demand exceeds capacity. Given the following variables: R is the set of routes; S the set of served customers; b i the beginning service time at customer i ; d j the total distance of route j .