Password: We consider an extension of the capacitated Vehicle Routing Problem (VRP), known as the Vehicle Routing Problem with Backhauls (VRPB), in which the set of customers is partitioned into two subsets: Linehaul and Backhaul customers. Each Linehaul customer requires the delivery of a given quantity of product from the depot, whereas a given quantity of product must be picked up from each Backhaul customer and transported to the depot. VRPB is known to be NP-hard in the strong sense, and many heuristic algorithms were proposed for the approximate solution of the problem with symmetric or Euclidean cost matrices. We present a cluster-first-route-second heuristic which uses a new clustering method and may also be used to solve problems with asymmetric cost matrix. The approach exploits the information of the normally infeasible VRPB solutions associated with a lower bound. The bound used is a Lagrangian relaxation previously proposed by the authors. The final set of feasible routes is built through a modified Traveling Salesman Problem (TSP) heuristic, and inter-route and intra-route arc exchanges. Extensive computational tests on symmetric and asymmetric instances from the literature show the effectiveness of the proposed approach. Keywords Vehicle routing ; Lagrangian relaxation ; Heuristic algorithms ; Local search 1. Introduction We consider an extension of the capacitated Vehicle Routing Problem (VRP), known as the Vehicle Routing Problem with Backhauls (VRPB), in which the set of customers is partitioned into two subsets: Linehaul and Backhaul customers. Each Linehaul customer requires the delivery of a given quantity of product from the depot, whereas a given quantity of product must be picked up from each Backhaul customer and transported to the depot. An example of this partition of the customer set, which is extremely frequent in practical situations, is represented by the grocery industry. In this case, supermarkets and shops are the Linehaul customers, and grocery suppliers are the Backhaul customers. In recent years it has been widely recognized that in this mixed distribution/collection context a significant saving in terms of transportation costs can be achieved by visiting Backhaul customers along distribution routes. For example, the Interstate Commerce Commission estimated to $160 millions the yearly saving obtained by the USA grocery industry due to the introduction of Backhauling (see, e.g., Golden et al., 1985 ). More precisely, the VRPB can be stated as the problem of determining a set of vehicle routes visiting all customers, and such that: (i) each vehicle performs one route; (ii) for each route the total load associated with Linehaul and Backhaul customers does not exceed, separately, the vehicle capacity; (iii) on each route the Backhaul customers, if any, are visited after all Linehaul customers; (iv) the total distance traveled by the vehicles is minimized. The precedence constraint (iii) is practically motivated by the fact that, in many applications, Linehaul customers have a higher service priority than the Backhaul customers. Another practical reason is that vehicles are often rearloaded, hence the onboard load rearrangement required by a “mixed” service is difficult, or even impossible, to carry out at customer locations. In this paper we examine both the symmetric and asymmetric versions of VRPB. In the symmetric version of the problem (indicated as VRPB, for short) the distance between each pair of locations is the same in the two directions, whereas we have the asymmetric version (indicated as AVRPB) when this assumption does not hold. The problem can also be formulated through the following graph theory model. Let G =( V 0 , A ) be a complete undirected graph (directed for AVRPB), with vertex set V 0 ≔{0}∪ L ∪ B . Subsets L ={1,…, n }, and B ={ n +1,…, n + m }, correspond to Linehaul and Backhaul vertex subsets, respectively. A nonnegative quantity, d j , of product to be delivered or collected ( demand ) is associated with each vertex j ∈ V , with V ≔ L ∪ B . Vertex 0 corresponds to the depot (with a fictitious demand d 0 =0), where K identical vehicles with a given capacity , D , are stationed. Let c ij be the nonnegative cost associated with arc ( i , j )∈ A , with c ij = c ji for each i , j ∈ V 0 such that i ≠ j , and c ii =+∞ for each i ∈ V 0 . VRPB (and AVRPB) then consists of finding a min-cost collection of K simple circuits (vehicle routes) such that: (i) each vehicle performs one circuit; (ii) each circuit visits vertex 0; (iii) each vertex j ∈ V is visited exactly once; (iv) the sum of the demands of the Linehaul and Backhaul vertices visited by a circuit does not exceed, separately, the vehicle capacity D ; (v) in each circuit the Linehaul vertices precede the Backhaul vertices, if any. The objective is to minimize the total routing cost, defined as the sum of the costs of the arcs belonging to the circuits. The mixed vehicle routes, i.e. routes which visit both Linehaul and Backhaul vertices, are implicitly oriented due to precedence constraint (v). Let K L (resp. K B ) denote the minimum number of vehicles needed to serve all the Linehaul (resp. Backhaul) vertices. In order to ensure feasibility, we assume that K (number of available vehicles) is not smaller than the minimum number of vehicles needed to serve all the vertices, i.e. K ⩾max{ K L , K B }. The values K L and K B can be obtained by solving the Bin Packing Problem (BPP) instances associated with the Linehaul and the Backhaul vertices, respectively. In these instances the bin capacity is equal to D and each item j has weight equal to the demand d j of the corresponding vertex. In spite of the fact that BPP is NP-hard in the strong sense, many instances with hundreds of items can be optimally solved very effectively (see, e.g., Martello and Toth, 1990 ). As generally assumed in the literature, routes containing only Backhaul vertices are not allowed. However, the heuristic approach presented in this paper may be easily extended to consider the case where this limitation is not present. VRPB is NP-hard in the strong sense, since it generalizes the capacitated VRP, arising when B =∅. All previous heuristic algorithms from the literature considered only the symmetric (or even the Euclidean) version of the problem. Deif and Bodin (1984) proposed an extension of the well-known Clarke–Wright VRP heuristic, where the saving of the arcs connecting Linehaul to Backhaul vertices is modified so as to delay the formation of mixed routes. Different extensions of the Clarke–Wright algorithm were presented by Casco et al. (1988) , and Golden et al. (1985) ; the latter deals with the case where the precedence constraint between Linehaul and Backhaul customers is not present. Goetschalckx and Jacobs-Blecha (1989) proposed an algorithm that builds initial routes with customers of the same type by using a spacefilling curves heuristic; these routes are then merged to form the final set of vehicle routes. Goetschalckx and Jacobs-Blecha (1993) also described an extension to VRPB of the Fisher–Jaikumar VRP heuristic ( Fisher and Jaikumar, 1981 ). A preliminary version of this work, where only the symmetric case is considered, appeared in Toth and Vigo (1996) . An exact, set-covering based, algorithm for the special case of VRPB where the number of customers of each type in a circuit is not greater than 4, was proposed by Yano et al. (1987) . Branch-and-bound exact algorithms for VRPB have recently been proposed by Toth and Vigo (to appear) , and by Mingozzi and Baldacci (1996) . In this paper we present a cluster-first-route-second heuristic which uses a new clustering method and may be used for the solution of both symmetric and asymmetric instances. The approach exploits the information of the normally infeasible VRPB (and AVRPB) solutions associated with a lower bound. The bound is a Lagrangian relaxation proposed by Toth and Vigo (to appear) . The clusters obtained are then combined by solving an auxiliary assignment problem and the initial, possibly infeasible, routes are built through a modified Traveling Salesman Problem (TSP) heuristic. The final set of feasible routes is obtained through inter-route and intra-route arc exchanges. The paper is organized as follows. A brief survey of the heuristic algorithms proposed in the literature is presented in Section 2 . The new heuristic is described in Section 3 , while extensive computational tests on symmetric and asymmetric problem instances from the literature, showing the effectiveness of the proposed approach, are finally discussed in Section 4 . 2. Heuristic algorithms from the literature The heuristic algorithms so far proposed for the solution of VRPB are extensions of algorithms for the VRP. All these heuristics were developed for the symmetric, and in many cases only the Euclidean, version of the problem. The extension of these methods to AVRPB is often difficult, or even impossible, and may lead to unpredictable results. The first heuristic algorithm for VRPB was proposed by Deif and Bodin (1984) . The algorithm, called DB hereafter, is an extension of the well-known Clarke and Wright (1964) heuristic for the VRP. The Clarke–Wright algorithm starts with an infeasible solution where each vertex is visited by a separate route. Routes are then iteratively combined by considering the “saving”, in terms of routing cost, that can be achieved by serving two vertices on the same route instead of leaving them on separate routes. The saving obtained by visiting vertices i and j in sequence on the same route can be expressed as: equation ( 1 )