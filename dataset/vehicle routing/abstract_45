Password: The Vehicle Routing Problem with Pickups and Deliveries (VRPPD) is an extension to the classical Vehicle Routing Problem (VRP), where customers may both receive and send goods. We do not make the assumption common in the VRPPD literature, that goods may only be picked up after all deliveries have been completed. We also eschew the concept of insertion and propose a method that treats pickups and deliveries in an integrated manner. This method finds a solution to the corresponding VRP problem and modifies this solution to make it feasible for the VRPPD. Such modification is achieved mainly by heuristic routines taken from VRP methodology but modified such that their aim becomes the reduction of infeasibilities, although a number of problem-specific routines are also constructed. To render our procedures efficient when checking feasibility, we built appropriate mathematical relationships to describe changes in the maximum load of routes. Furthermore, several enhancements are introduced. Our methodology is also capable of solving multi-depot problems, which has not been done before for this challenging general version of the VRPPD. The methods are tested for single and multiple depot problems with encouraging results. Keywords Vehicle routing ; Heuristics ; Pickups and deliveries ; Multiple depots 1. Introduction The Vehicle Routing Problem with Pickups and Deliveries ( VRPPD ) is an extension to the vehicle routing problem (VRP) where the vehicles are not only required to deliver goods to customers but also to pick some goods up at customer locations. It is normally assumed that goods stored at some customer location cannot directly be transported to another customer. In other words, all goods have to either originate from, or end up, at a depot. Thus, problems such as the dial-a-ride problem are excluded from our consideration, although some authors do refer even to these as pickup-and-delivery problems. It is also usually assumed that the number of vehicles is not fixed in advance. The objective function of the VRPPD is to minimise the total distance travelled by the vehicles, subject to maximum distance and maximum capacity constraints on the vehicles. We also mention that the VRPPD is NP-hard, being a generalisation of the classical VRP. It can be formulated as a mixed ILP (see Appendix A for a possible formulation), and solved by exact methods for small problems. Our focus, however, will exclusively be on heuristics. Within the above assumptions, three important VRPPD models may be distinguished. In the following, we briefly describe these models, and then present and explain our choice of model. Delivery-first , pickup-second VRPPD . Most researchers make the assumption that customers can be divided into linehauls (customers receiving goods) and backhauls (customers sending goods); furthermore vehicles can only pick up goods after they have finished delivering all their load. One reason for this is that it may be difficult to re-arrange delivery and pickup goods on the vehicles. We note that such an assumption makes the implementation issue easier, since accepting pickups before finishing all deliveries results in a fluctuating load. This may cause the vehicle to be overloaded during its trip (even if the total delivery and the total pickup loads are not above the vehicle capacity), resulting in an infeasible vehicle tour. Mixed pickups and deliveries . A VRPPD where linehauls and backhauls can occur in any sequence on a vehicle route is referred to as a mixed VRPPD. Delivery-first pickup-second and mixed VRPPD problems are jointly referred to as the vehicle routing problem with backhauling ( VRPB ). Simultaneous pickups and deliveries . In this model, customers may simultaneously receive and send goods. We note that mixed and simultaneous VRPPD problems can be modelled in the same framework. Mixed problems can be thought of as simultaneous ones with either the pickup or the delivery load being nil; while the customers of simultaneous problems can be divided into pickup and delivery entities to give a mixed formulation. (In the simultaneous problem, there may be a further restriction on serving the pickup and delivery of a customer at the same time.) The aims of this study are to produce an efficient composite heuristic approach for both the simultaneous and the mixed VRPPD and to extend the methodology to the multiple depot VRPPD problem. We do not address the delivery-first pickup-second problem. This is because we believe that this assumption is unnecessarily restrictive, and results in poor quality solutions. Consider the following example. A depot d is located at coordinates (0,0) and customers a , b and c are located at coordinates (1,0), (1,1) and (0,1), respectively (see Fig. 1 ) Customer a and c need 9 tons and 1 ton, customer b sends 2 tons. The capacity of the vehicle is 10 tons. The optimal mixed VRPPD solution is dabcd , with a length of 4 units. The optimal delivery-first pickup-second solutions are dacbd and dcabd , with a length of 4.828 units. Thus, this restriction resulted in an increase of over 20%. Fig. 1.Â  An example of the drawback of the delivery-first pickup-second assumption. We agree that serving pickups and deliveries in a mixed order or simultaneously causes difficulties, due to the rearrangements of goods on board. However, it is not an impossible task, especially if the vehicle is nearly empty. Some vehicles also have a better design (e.g. both rear and side loading), making rearrangement of goods a more practical option. From a managerial viewpoint, it is useful to find the solutions to both problems, as this can help in evaluating the cost benefit against the inconvenience caused by the need to rearrange. Such inconvenience could be looked at and examined whether it is worthwhile pursuing. It is not possible to directly compare our methods with delivery-first pickup-second algorithms, as our solutions may violate the delivery-first pickup-second restriction. If such a restriction must be imposed, then a different methodology is likely to be more suitable. The special structure of the routes in this case makes them more suitable to be solved as matching problems, since routes consist of two distinct parts (a delivery and a pickup segment). In any case, our aim is not to find small increases in solution quality, but to develop a solution methodology that is capable of solving a wider class of problems than previously solved in the literature. In Section 2 , we present a review of the literature. The overall structure of the new heuristic is given in Section 3 and its details are presented in Section 4 . Some enhancements of this method are introduced in Section 5 and an adaptation to the case of multiple depots is presented in Section 6 . We provide the computational results in Section 7 . Finally, we present our conclusions and outline some suggestions for future work. 2. Literature review simultaneous pickups and deliveries, (ii) mixed pickups and deliveries, and (iii) problems where pickups are only allowed to occur after deliveries. Summary descriptions of the various papers are presented in Table 1 . The reader is also referred to the paper of Savelsbergh and Sol (1995) , which presents a review of papers on a wider class of pickup-and-delivery problems and gives a different classification.