Password: This paper proposes a formulation of the vehicle routing problem with simultaneous pickup and delivery (VRPSPD) and a particle swarm optimization (PSO) algorithm for solving it. The formulation is a generalization of three existing VRPSPD formulations. The main PSO algorithm is developed based on GLNPSO, a PSO algorithm with multiple social structures. A random key-based solution representation and decoding method is proposed for implementing PSO for VRPSPD. The solution representation for VRPSPD with n customers and m   vehicles is a (n+2m) ( n + 2 m ) -dimensional particle. The decoding method starts by transforming the particle to a priority list of customers to enter the route and a priority matrix of vehicles to serve each customer. The vehicle routes are constructed based on the customer priority list and vehicle priority matrix. The proposed algorithm is tested using three benchmark data sets available from the literature. The computational result shows that the proposed method is competitive with other published results for solving VRPSPD. Some new best known solutions of the benchmark problem are also found by the proposed method. Scope and Purpose This paper applies a real-value version of particle swarm optimization (PSO) algorithm for solving the vehicle routing problem with simultaneous pickup and delivery (VRPSPD). The VRPSPD formulation is reformulated and generalized from three existing formulations in the literature. The purposes of this paper are to explain the mechanism of the PSO for solving VRPSPD and to demonstrate the effectiveness of the proposed method. Keywords Vehicle routing problem ; Simultaneously pickup and delivery ; Particle swarm optimization ; Random key representation ; Metaheuristics 1. Introduction The vehicle routing problem (VRP) is a generic name given to a class of problems to determine a set of vehicle routes, in which each vehicle departs from a given depot, serves a given set of customers, and returns back to the same depot. Various types of service appear in practical situations, while physical delivery of goods is the most common one. The basic VRP involves a single depot, a fleet of identical vehicles that stations at the depot, and a set of customers who require delivery of goods from the depot. The objective of basic VRP is to minimize the total routing cost, subject to maximum working time and maximum capacity constraints on the vehicles [1] . Besides the basic VRP, many VRP variants may appear since there are many possibilities in real-life problem settings and characteristics, for example: the number of depots, type of vehicle, and customer requirements. Toth and Vigo [2] provide comprehensive details on VRP, its variants, formulation, and solution methods. One extension of the basic VRP is the vehicle routing problem with simultaneous pickup and delivery (VRPSPD). In this variant, customers require not only the delivery of goods but also the simultaneous pick up of goods from them. A general assumption is that all delivered goods originate from the depot and all pickup goods must be transported back to the depot. Min [3] was inspired by a distribution problem of a public library and first introduced this extension as the VRPSPD for minimizing the total travel time of the route by considering the vehicle capacity as the problem constraint. His proposed solution procedure for the problem consists of three phases: clustering customer nodes, assigning vehicles to clusters, and creating the route of each vehicle. After Min [3] , some researchers also contributed on the mathematical formulation of VRPSPD and the solution techniques. Dethloff [4] discussed the importance of VRPSPD in the reverse logistic operations. He proposed a mathematical formulation for the problem to minimize the total traveled distance subject to maximum capacity constraint of the vehicle. He also developed an insertion-based heuristic that use four different criteria to solve the problem. Salhi and Nagy [5] proposed four insertion-based heuristics for generating solution for VRPSPD. The basic steps of these heuristics are constructing partial routes for a set of customers, and then inserting the remaining customers to the existing route. These heuristic rules were differentiated mainly by the criteria for insertion and number of customers per insertion. Nagy and Salhi [6] also proposed a local search heuristic with four phases to solve VRPSPD. After finding an initial solution in the first phase, it is continuously improved in each of the following phases while maintaining a certain feasibility condition. In both papers, they addressed not only the VRPSPD, but also the mixed case of VRP where some customers require delivery and the other customers require pickup. They showed that the VRPSPD is a generalization of the mixed problem. In addition, they also extended the method for the multi depot case. Tang and Galvao [7] developed a tabu search algorithm to solve VRPSPD. The algorithm combines several efforts to obtain alternative inter-route and intra-route solutions, includes relocation of a customer from one route to another route, interchange a pair of customers between two routes, crossover two routes, and 2-opt procedure. In their formulation, the VRPSPD is formulated to minimize the total traveled distance of the route subject to maximum distance and maximum capacity constraints on the vehicles. Bianchessi and Righini [8] proposed heuristic algorithms for solving VRPSPD. Their work comprised of four different constructive algorithms, local search algorithms with various neighborhood structures, and tabu search algorithms. They were using Dethloff's VRPSPD formulation and their computational result outperformed result in Dethloff [4] . Dell’Amico et al. [9] was the first published work on exact method for solving VRPSPD. They presented an optimization algorithm based on column generation, dynamic programming, and branch and price method. However, the computational complexity of VRPSPD is evident from the computational result, in which 1 h of computational time sometimes is not enough for solving a small size problem consist of 40 customers. It is noted that the VRPSPD can be seen as a pickup and delivery problem (PDP). In the recent classification on static pickup and delivery problem by Berbeglia et al. [10] , the VRPSPD is called the multi-vehicle Hamiltonian one-to-many-to-one pickup and delivery problem with combined demands. By this definition, the problem consists of multi vehicles which its routes are a Hamiltonian cycle; the deliveries are from depot and the pickups will be transferred back to depot (one-to-many-to-one); the customer demand is combined which means that at least there is one customer with non zero pickup and delivery demand. PSO is a population-based search method proposed by Kennedy and Eberhart [11] , which motivated by the group organism behavior such as bee swarm, fish school, and bird flock. PSO imitated the physical movements of the individuals in the swarm as a searching method. A brief and complete survey on PSO mechanism, technique, and application is provided by Kennedy and Eberhart [12] and also Clerc [13] . While some other population-based search methods had been successfully applied in broader area of VRP, such as genetic algorithm [14] , [15]  and  [16] and ant colony optimization [17]  and  [18] , the application of PSO on VRP is still rare. One is the work of Chen et al. [19] , where the discrete version of PSO is combined with Simulated Annealing (SA) algorithm for solving the basic VRP. There are two main contributions of this paper. First, it reformulates the VRPSPD as a direct extension of the basic VRP. As a result, the formulation of Min [3] , Dethloff [4] , Tang and Galvao [7] can be reduced to a special case of this reformulation. Second, it fills the gap of the application of PSO for VRP solution by showing how the real-valued version of PSO is applicable for solving VRPSPD. The proposed algorithm in this paper is different from Chen's algorithm [19] in two aspects. First, the algorithm uses real value instead of discrete value for search variables. Second, it is implemented without the use of any local search method. The remainder of this paper is organized as follows: Section 2 reviews the VRPSPD definition and mathematical formulation. Section 3 describes the proposed PSO algorithm for solving VRPSPD. Section 4 discusses the computational experiment of the proposed PSO on a benchmark data set. Finally, Section 5 concludes the result of this research and suggests further direction of the future research.