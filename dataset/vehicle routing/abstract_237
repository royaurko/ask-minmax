Password: In this paper we use an ant colony system (ACS) algorithm to solve the vehicle routing problem with simultaneous delivery and pickup (VRPSDP) which is a combinatorial optimization problem. ACS is an algorithmic approach inspired by the foraging behavior of real ants. Artificial ants are used to construct a solution for the problem by using the pheromone information from previously generated solutions. The proposed ACS algorithm uses a construction rule as well as two multi-route local search schemes. The algorithm can also solve the vehicle routing problem with backhaul and mixed load (VRPBM). An extensive numerical experiment is performed on benchmark problem instances available in literature. It is found that ACS gives good results compared to the existing algorithms. Keywords Metaheuristic ; Ant-colony ; Vehicle routing ; Simultaneous delivery and pickup 1. Introduction Traditional supply chain management has focused on the forward flow of materials. However, the new environmental regulations and the incentives for returning and reusing products have increased the reverse flows in supply chains in recent years. The need for managing the reverse flow of materials has opened a new field in supply chain management called reverse logistics. Reverse logistics attempts to generate additional revenue by recapturing the value otherwise lost or underutilized in the supply chain. One of the problems in reverse logistic is that the vehicle planner and dispatcher needs to consider the delivery and pickup of materials from a customer by a single vehicle. The vehicle routing problem with simultaneous delivery and pickup (VRPSDP) is characterized by the following: a fleet of identical vehicles located at the depot to be used to serve customers distributed geographically in the area. The capacity of each vehicle is Q Q . A customer requires a given shipment to be delivered and another load to be picked up during the single visit of a vehicle. The objective is to design a set of minimum cost routes to serve all customers so that the load on a vehicle is below vehicle capacity Q Q at each point in the route. VRPSDP is an NP-hard problem in the strong sense because when we set either all pickup demands or all delivery demands to zero, the problem reduces to the capacitated vehicle routing problem (CVRP) which is a known NP-hard problem. VRPSDP is closely related to the vehicle routing problem with backhauls (VRPB) which requires that all deliveries to the linehaul customers must be made before any pickup from a backhaul customer. When the delivery or pickup is allowed in any order of sequence, the problem is called vehicle routing problem with backhaul and mixed load (VRPBM). VRPBM is considered to be a special case of VRPSDP because when we set either the delivery or pickup demand of each customer to zero, the problem reduces to VRPBM. See Dethloff [12] and Bianchessi and Righini [2] for mathematical formulation of VRPSDP. Berbeglia et al. [1] have provided the classification scheme for a static pickup and delivery problem. In this classification scheme, the problems of VRPSDP and VRPBM fall under the category of one to one pickup and delivery problem. 2. Literature survey We survey the literature in two parts. The first part is on the VRPBM where the linehaul and backhaul customers are served in any sequence. The second part is on the VRPSDP in which a customer requires some quantity of materials to be delivered as well as a load to be picked up during the same visit. There are relatively few papers which deal with VRPBM. Deif and Bodin [10] extended the classical saving heuristic of Clarke and Wright to solve VRPBM. They calculate the saving between the linehaul and backhaul customer by adding a penalty term to postpone the insertion of the backhaul customer in the route. Cosco et al. [8] combined the saving method with load based insertion method to solve VRPBM. Golden et al. [18] , Cosco et al. [8] and Salhi and Nagy [29] combined Clarke and Wright saving heuristic with an insertion based heuristic. These papers first solve CVRP consisting only of the linehaul customers and then insert backhaul customers in the route. They differ in the way a backhaul customer is inserted in the existing route. Golden et al. [18] consider the number of linehaul customers left on the route after the insertion of a backhaul customer whereas Cosco et al. [8] consider the remaining load to be delivered after the insertion of a backhaul customer. Salhi and Nagy [29] adopted a similar approach but they insert two backhaul customers at a time in the route. Mosheiov [23] proposed a heuristic based upon the tour partitioning approach. Wade and Salhi [34] designed an ant colony system (ACS) algorithm for VRPBM. Recently Bianchessi and Righini [2] have proposed a tabu search algorithm using complex and variable neighborhood approach. VRPSDP was introduced by Min [22] to solve a real life problem of transporting books between libraries. He used the cluster first and route second approach to solve the problem. A TSP problem is solved exactly during the routing phase and if the TSP route violates the vehicle capacity constraint then the TSP problem is resolved by penalizing the arc violating the vehicle capacity constraint. Salhi and Nagy [29] solved VRPSDP using the insertion based heuristic that they designed for VRPBM. They also extended the VRPBM heuristic to multi-depot version of the problem. Dethloff [12] described the application of VRPSDP in reverse logistics. He proposed an insertion based heuristic which uses the concept of the residual load. Recently a number of authors have proposed metaheuristics—mainly tabu search—to solve VRPSDP (e.g. [9] , [5] , [32]  and  [2] ). An exact method based upon the branch and price method is proposed for VRPSDP by DellAmico et al. [11] . In recent years, several authors have applied ACS metaheuristic to vehicle routing problems. For an introduction to the ACS approach see Dorigo et al. [16] . Bullenheimer et al. [4] designed an ACS for CVRP. This ACS is further improved by Doerner et al. [13] by combining it with the savings heuristic. Reimann et al. [27] proposed a decomposition approach (D-Ants) for CVRP. Wade and Salhi [34] designed an ant colony algorithm for VRPBM. In most of the above papers, local search is used to improve a given vehicle route. In this paper we present an ACS algorithm for solving VRPSDP. We use two multi-route local search schemes based upon interchange and insertion operations and an exchange of sub-paths. This paper is organized as follows. Section 3 describes the local search schemes used in ACS. Section 4 describes the ACS algorithm for VRPSDP. An extensive computational experiment with benchmark problem instances available in literature is presented in Section 5 . We compare the performance of different algorithms with ACS. Conclusions follow in Section 6 . 3. Local search Local search is an important part of metaheuristics including ACS. In this section we present three types of local search schemes: 2-opt scheme, the customer insertion/interchange multi-route scheme and the sub-path exchange multi-route scheme. Given that the load fluctuates over the route, one important issue in VRPSDP and VRPBM is checking the feasibility of a route during local search. In this paper, we use an approach based upon the notion of cumulative net-pickup load. The detail of the cumulative net-pickup approach can be found in Gajpal and Abad [17] which describes how the feasibility check is performed in constant time for the three local search schemes described in next sub-sections. 3.1. 2-Opt local search scheme The 2-opt local search scheme was originally proposed by Lin [21] for improving the traveling salesman problem (TSP) solution. It is one of the best known local search schemes for TSP and it is based on the arc exchange approach. In CVRP, each vehicle route is a TSP. The 2-opt scheme starts with a given route and breaks it at two places to generate three segments. We view a route as a path that starts and ends at the depot. The route is then reconstructed by reversing the middle segment (the segment that does not consist the depot). A given route is broken at each combination of two places and is updated whenever there is an improvement. The process is continued until there is no further improvement. In CVRP, the new route is always feasible while performing the 2-opt local search since the total demand of a given route does not change. However, this is not true for VRPSDP. In VRPSDP, the load on the vehicle fluctuates and it may exceed the vehicle capacity at some arc. In this paper we define the feasible route as a route in which the load along each arc is less than or equal to the vehicle capacity and the total distance traveled is less than or equal to the allowable maximum distance.