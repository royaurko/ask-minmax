Password: This paper presents a two-stage hybrid algorithm for pickup and delivery vehicle routing problems with time windows and multiple vehicles (PDPTW). The first stage uses a simple simulated annealing algorithm to decrease the number of routes, while the second stage uses Large neighborhood search (LNS) to decrease total travel cost. Experimental results show the effectiveness of the algorithm which has produced many new best solutions on problems with 100, 200, and 600 customers. In particular, it has improved 47% and 76% of the best solutions on the 200 and 600-customer benchmarks, sometimes by as much as 3 vehicles. These results further confirm the benefits of two-stage approaches in vehicle routing. They also answer positively the open issue in the original LNS paper, which advocated the use of LNS for the PDPTW and argue for the robustness of LNS with respect to side-constraints. 1. Introduction Multiple vehicle routing problems with time windows (VRPTW) have received considerable attention in the last decades. These problems are often approached by meta-heuristics, since problems with as few as 100 customers are currently beyond the scope of state-of-the-art systematic search algorithms. Recent work on the VRPTW has produced significant improvements in solution quality and execution time, often by combining several approaches or heuristics. Comparatively, little research was devoted to pickup and delivery problems with multiple vehicles and time windows (PDPTW) until recently (e.g., [1] , [2] , [3]  and  [4] ). Customers in the PDPTW are divided into pickup and delivery pairs. Given such a pair (p,d) ( p , d ) , a routing must service customers p p and d d with the same vehicle and must schedule the pickup customer p p before the delivery customer d d . In standard benchmarks [1] , the goal is to minimize the number of used vehicles and, in case of ties, the total travel cost. The difficulty in pickup and delivery problems, which partly explains why it is less studied than the VRPTW, lies in the side-constraints, which complicate the neighborhoods and invalidate many of the traditional VRPTW moves [5] . However, many practical applications naturally exhibit pickup and delivery constraints in their modeling. This includes dial-a-ride problems, airline scheduling, bus routing, tractor-trailer problems, helicopter support of offshore oil field platforms, and logistics and maintenance support [3] . More generally , industrial vehicle routing problems are rarely pure and often feature side-constraints . Because of its practical relevance and its side-constraints , the PDPTW is a natural model to evaluate the robustness and scalability of various approaches with respect to side-constraints . This paper proposes a two-stage hybrid algorithm for the PDPTW. The overall structure of the algorithm is motivated by the recognition that minimizing the objective function directly may not be the most effective way to decrease the number of routes in vehicle routing problems (e.g., [6]  and  [7] ). Indeed, the objective function often drives the search toward solutions with low travel cost, which may make it difficult to reach solutions with fewer routes but higher travel cost. To overcome this limitation, our algorithm divides the search in two steps: (1) the minimization of the number of routes and (2) the minimization of total travel cost. This two-step approach makes it possible to design algorithms tailored to each sub-optimization. Our algorithm uses two distinct local search procedures to exploit the specificities of each subproblem. The first step uses a very simple simulated annealing (SA) algorithm to minimize the number of routes. The SA algorithm only uses relocation of pairs of customers and one of its key aspects is a lexicographic evaluation function which minimizes the number of routes (primary criterion), maximizes the sum of the squares of the route sizes (secondary criterion), and minimizes travel cost of the routing plan (third criterion). The second criterion was also used successfully in other applications (e.g., graph coloring [8] and, more recently, vehicle routing [6] ). The second step uses large neighborhood search (LNS) [9] to minimize total travel cost. It is motivated by our experience that LNS is particularly effective in minimizing total travel cost when given a solution that minimizes the number of routes, and when the problem is highly constrained [6] . The use of LNS for pickup and delivery problems was in fact suggested in the original LNS paper [9] , because of its ability to handle side-constraints gracefully. Experimental results on difficult PDPTW problems demonstrate the effectiveness of the algorithm. On the standard 100, 200, and 600 customers benchmarks [1] , our algorithm produces 2, 25 (47%), and 46 (76%) new best solutions respectively, while matching or being close to best known solutions on the other instances. In several 600-customer instances, the algorithm decreases the number of vehicles by as much as 3. These results further confirm the effectiveness of two-stage approaches in vehicle routing, answers positively the open question in [9] on the potential of LNS for the PDPTW, and demonstrate the critical role of the first phase to boost LNS. Similarly, this research confirms that the structure of LNS makes it relatively easy to incorporate pickup and delivery constraints in our previous hybrid algorithm [6] , validating Shaw's claim on the robustness of LNS w.r.t. side constraints. 1.1. Related work Single vehicle pickup and delivery problems were first introduced by Psarafis [10] in 1980. Small instances of multiple vehicle problems with time windows were introduced and solved optimally in [11] . A good survey of the various models and techniques utilized in early work on pickup and delivery problems can be found in [5] . A more recent book on vehicle routing [12] , provides an excellent overview of techniques for solving vehicle routing problems. Of particular interest is Chapter 9 which covers pickup and delivery problems. More recent advances on multiple vehicle problems have focused on meta-heuristics including tabu search and SA. Tabu search was used in [3]  and  [13] to minimize another objective function, i.e., total schedule duration, in pickup and delivery problems. They use pair relocation as one of their neighborhood operators to move customers between routes. They also introduced pair exchange operators and a single customer relocation within the same route. A tabu search/SA annealing hybrid was successfully used in [1] to solve the PDPTW. This algorithm was compared in detail in the experimental section. Excellent results were also produced in [4] but the report is not available unfortunately. A squeaky wheel algorithm was also proposed in [2] , but it does not seem to be competitive with the two earlier algorithms in solution quality. The rest of this paper is organized as follows. Section 2 specifies the PDPTW and describes the notations. Section 3 gives an overview of the overall algorithm. Section 4 presents the SA algorithm, while Section 5 describes the LNS algorithm for minimizing travel costs. Section 6 presents the experimental results. Section 7 concludes the paper. 2. Problem formulation This section defines the pickup and delivery vehicle routing problem with time windows (PDPTW) and the various concepts used in this paper.