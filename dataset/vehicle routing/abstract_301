Password: We address a problem of vehicle routing that arises in picking up and delivering full container load from/to an intermodal terminal. The substantial cost and time savings are expected by efficient linkage between pickup and delivery tasks, if the time of tasks and the suitability of containers for cargo allow. As this problem is NP-hard, we develop a subgradient heuristic based on a Lagrangian relaxation which enables us to identify a near optimal solution. The heuristic consists of two sub-problems: the classical assignment problem and the generalized assignment problem. As generalized assignment problem is also NP-hard, we employ an efficient solution procedure for a bin packing based problem, which replaces the generalized assignment problem. The heuristic procedure is tested on a wide variety of problem examples. The test results demonstrate that the procedure developed here can efficiently solve large instances of the problem. Keywords Logistics ; Container transportation ; Vehicle routing ; Heuristics ; Lagrangian relaxation 1. Introduction This paper aims to model and solve a complex routing problem associated with the pickup and delivery of containers. An intermodal transportation system comprises several means of transportation such as sea, rail and road. Intermodal shipments in containers are distributed, by trucks, to customers from interchange nodes (or intermodal terminals) such as ports and rail-yards. The container distribution is divided into two activities: pickup and delivery. These activities are essentially independent. A trailer-truck delivers a full (or loaded) container to a consignee from an intermodal terminal and hauls back empty to the terminal after unloading goods at the consignee site (delivery trip). Contrary to this, in a pickup activity a trailer-truck hauls an empty container to a shipper and takes a filled container back to the terminal after loading at the shipper (pickup trip). Most shippers and consignees are located close together in a distribution area nearby a terminal, especially in Japan. Therefore, if criteria in compatibility, such as the time of shipment and the suitability of container to cargo in terms of type and size, are satisfied, a direct transfer of an empty container from a delivery point to a site for a subsequent shipment may be possible, reducing the trip length of empty trailer-truck (or deadhead). Such a direct transfer, which can be viewed as a merged route for delivery and pickup trips, also leads to the efficient use of empty containers. A trailer-truck consists of a tractor and a trailer, and normally they can be uncoupled (in Japan most trailer-trucks designed for domestic container distribution cannot). Consequently, when a long loading or unloading process is expected, a tractor uncouples a trailer (or a chassis with a container on it) and leaves it at a customer site so that the truck can be assigned to the next shipment. However, this is not likely the case especially for intermodal container transportation within Japan, mainly because of the complexity of the tractor assignment to trailer and the physical feature of trailer-truck as mentioned above. A firm usually has an option of either buying its own fleet of trucks or leasing it to carry out distribution. As the fleet size that satisfies the peak demand is not considered appropriate due to the capital and operating costs, the firm invests in a moderate size of fleet between the highest and lowest demands being estimated for the planning horizon, and in the operational phase the firm charters an additional fleet to cover the excess demand. Once the owned fleet is held, the capital costs including the driver’s costs are regarded as the sunk costs, i.e., the costs are incurred for the truck’s lifetime regardless of the amount of workload. The fuel costs are, however, typically incurred with revenue runs (and empty runs as well). From this point of view, the own fleet-related costs (mostly fuel costs) are less than the chartering costs, which are assumed to vary depending on the time length of charter to distribute cargoes. In this context, it is important to allocate as many distribution tasks to the own fleet as possible to reduce the entire distribution costs. Such an efficient task allocation plan, however, is not easy to be made because of the restrictive overwork of the own fleet. If the task allocation including own and outside fleets is not well planned, the firm needs to hire much more expensive outside trucks. Motivated with the above-mentioned issues in the own fleet operation for container cargo delivery, we consider the problem called the vehicle routing problem with full container load (VRPFC) that is defined as follows: Assuming the homogeneous container type and size and own and chartered fleets with different hauling costs and working time lengths, find the optimal assignment of the own and chartered fleets to a set of delivery and pickup point pairs (hereafter referred to as D–P pairs ), in order to minimize the total distribution cost. We treat the container distribution from a single terminal on a day. Note that as we focus on the domestic intermodal transportation, we do not assume a sophisticated and dynamic operation based on the separate use of tractor and trailer. As will be proven later, the VRPFC is an NP-hard problem. Thus, we propose a Lagrangian relaxation-based heuristic for that problem. As mentioned above, this study assumes the homogeneous container type and size. This assumption is realistic in many cases for the following reasons: In the domestic container transportation system of Japan, there are normally three types of containers in size: 12-, 20- and 30-ft containers. If a shipment needs a 12-ft container, the shipment can be physically made up with a larger container. Container size compatibility can be seen in international container transportation systems, too. However, such a size substitution may apply a different freight rate and other transport-related agreements. The type substitution is more difficult than the size substitution. The problem we consider can be modified so that multiple kinds of containers are dealt and the same kind of containers are reused among specific customer sites. However, such a modification is a future research topic. This paper is organized as follows. The next section describes the outline of the problem. Section 3 reviews the related literature. The problem formulation and its Lagrangian relaxation are described in Section 4 . Section 5 outlines a subgradient method to yield a near optimal solution, highlighting an algorithm that obtains a feasible solution from a solution to the relaxation problem. Extensive numerical experiments are carried out in Section 6 , followed by Section 7 that concludes the paper. 2. Problem description The VRPFC is defined on a graph G  = ( V ,  A ) where V is a vertex set representing the terminal, pickup points (or shippers) and delivery points (or consignees) and A is the arc set. There are two types of trips, each relevant to delivery point or pickup point as illustrated in Fig. 1 (a). A delivery trip and a pickup trip can be merged as shown in Fig. 1 (b) if the compatibility of container and the time of the delivery and pickup are satisfied. The problem is to minimize the total distribution cost where container distribution trips are serviced by various trailer-trucks (hereafter referred to as trucks) with respective working time criterion being allowed (referred to as the time capacity in the remaining part of the paper). The trucks employed for the container distribution are categorized into own and chartered, while the distinction is not essential in the problem. As mentioned in Section 1 , the chartered truck is more expensive than the owned one if the sunk cost of the own truck is ignored. The owned truck has a shorter time capacity than the chartered one, mainly because of the labor union of the firm. The merged trips are serviced by the own trucks as long as their time capacity allows. This task assignment policy may be interpreted as follows: The total cost of the own fleet is higher than the chartered ones if the sunk cost is included, thus the firm deploys the limited number of own trucks. The firm assigns as many tasks to the own fleet as possible because the expensive own fleet with the sunk cost should be effectively utilized with the time capacity. Fig. 1.  Note that individual trips remain if the number of delivery points is not equal to the number of pickup points. Trips that are not served by the own trucks are covered by the chartered trucks. All the trips are serviced since it is assumed that the firm can charter as many outside trucks as possible.