Password: We present a unified heuristic which is able to solve five different variants of the vehicle routing problem: the vehicle routing problem with time windows (VRPTW), the capacitated vehicle routing problem (CVRP), the multi-depot vehicle routing problem (MDVRP), the site-dependent vehicle routing problem (SDVRP) and the open vehicle routing problem (OVRP). All problem variants are transformed into a rich pickup and delivery model and solved using the adaptive large neighborhood search (ALNS) framework presented in Ropke and Pisinger [An adaptive large neighborhood search heuristic for the pickup and delivery problem with time windows. Transportation Science, to appear]. The ALNS framework is an extension of the large neighborhood search framework by Shaw [Using constraint programming and local search methods to solve vehicle routing problems. In: CP-98, Fourth international conference on principles and practice of constraint programming, Lecture notes in computer science, vol. 1520, 1998. p. 417–31] with an adaptive layer. This layer adaptively chooses among a number of insertion and removal heuristics to intensify and diversify the search. The presented approach has a number of advantages: it provides solutions of very high quality, the algorithm is robust, and to some extent self-calibrating. Moreover, the unified model allows the dispatcher to mix various variants of VRP problems for individual customers or vehicles. As we believe that the ALNS framework can be applied to a large number of tightly constrained optimization problems, a general description of the framework is given, and it is discussed how the various components can be designed in a particular setting. The paper is concluded with a computational study, in which the five different variants of the vehicle routing problem are considered on standard benchmark tests from the literature. The outcome of the tests is promising as the algorithm is able to improve 183 best known solutions out of 486 benchmark tests. The heuristic has also shown promising results for a large class of vehicle routing problems with backhauls as demonstrated in Ropke and Pisinger [A unified heuristic for a large class of vehicle routing problems with backhauls. European Journal of Operational Research, 2004, to appear]. Keywords Metaheuristics ; Large neighborhood search ; Vehicle routing problem 1. Introduction Most scientific papers in the area of heuristic solution methods for vehicle routing problems target a specific vehicle routing problem, e.g. vehicle routing problems with time windows (VRPTW). In such papers a heuristic is designed, implemented and fine-tuned to fit this particular problem type. Only a few papers (see e.g. [1]  and  [2] ) consider heuristics that “out-of-the-box” can be used to solve several problem types. We believe that general vehicle routing heuristics are an important research area as such heuristics are needed for real life problems, in which the transportation needs of different companies often are different and thus call for various types of vehicle routing problems. The heuristic in this paper is applied to five different problems: the VRPTW, the capacitated vehicle routing problem (CVRP), the multi-depot vehicle routing problem (MDVRP), the site-dependent vehicle routing problem (SDVRP) and the open vehicle routing problem (OVRP). In the CVRP one has to deliver goods to a set of customers with known demands on minimum-cost vehicle routes originating and terminating at a depot. The vehicles are assumed to be homogeneous and having a certain capacity. In some versions of the CVRP one also has to obey a route duration constraint that limits the lengths of the feasible routes. The VRPTW extends the CVRP by associating time windows with the customers. The time window defines an interval during which the customer must be visited. The OVRP is closely related to the CVRP, but contrary to the CVRP a route ends as soon as the last customer has been served as the vehicles do not need to return to the depot. The MDVRP extends the CVRP by allowing multiple depots. The SDVRP is another generalization of the CVRP in which one can specify that certain customers only can be served by a subset of the vehicles. Furthermore, vehicles do not need to have the same capacity in the SDVRP. In the CVRP, MDVRP and SDVRP one seeks to minimize the total traveled distance, whereas in the OVRP and VRPTW, the first priority is to minimize the number of vehicles and minimizing the traveled distance is the second priority. The choice of objective is not an intrinsic feature of the problems, but just the tradition in the metaheuristic literature. Most exact methods and some metaheuristics for the VRPTW minimize total traveled distance instead of minimizing number of vehicles used. All problem types are transformed to a rich pickup and delivery problem with time windows (RPDPTW) and are solved using the adaptive large neighborhood search (ALNS) framework introduced by [3]  and  [4] . The heuristic presented in the two aforementioned papers has been reused, with some small improvements (summarized in Section 5 ), to solve the five problem types considered in this paper. In the RPDPTW, we have a number of requests to be carried out by a given set of vehicles. Each request consists of picking up a quantity of goods at one location and delivering it to another location. The objective of the problem is to find a feasible set of routes for the vehicles so that all requests are serviced, and such that the overall travel distance is minimized. A feasible route of a vehicle must start at a given location, service a number of requests such that the capacity of the vehicle is not exceeded, and finally end at a given location. A pickup or delivery must take place within a given time window. Each request has an associated pickup precedence number, and a delivery precedence number. A vehicle must visit the locations in nondecreasing order of precedences (see e.g. [5] for various applications of precedence constraints). Since not all vehicles may be able to service all requests (e.g. due to their physical size or the absence of some cooling compartments) we need to ensure that every request is serviced by a given subset of vehicles. Between any two locations we have an associated, nonnegative distance and travel time. It is assumed that travel times satisfy the triangle inequality . This assumption implies that any removal of requests from a feasible route will keep the route feasible with respect to the imposed time windows. The five vehicle routing problems considered in the present paper have all been intensively studied in the literature. The two best known problems are the VRPTW and the CVRP. The VRPTW has been the target of extensive research and almost any type of metaheuristic has been applied to the problem. For recent surveys on the state of the art in VRPTW research we recommend the survey by Cordeau et al. [6] that describes both exact and heuristic methods, and the survey by Bräysy and Gendreau [7] that focuses on metaheuristics. It is hard to single out a few VRPTW metaheuristics as the number of proposed heuristics is huge, and no heuristic dominates all the other heuristics in all aspects. We would, however, like to mention the metaheuristic by Mester and Bräysy [8] as it has achieved outstanding results on larger VRPTW instances with between 200 and 1000 customers. For the smaller VRPTW instances like the Solomon data set, some of the best heuristics in terms of solution quality achieved are the large neighborhood search by Bent and Van Hentenryck [9] and the hybrid genetic algorithm by Homberger and Gehring [10] . Solving the VRPTW to optimality has also received much attention. The current state of the art exact methods are proposed by Kallehauge et al. [11] , Irnich and Villeneuve [12] and Chabrier [13] , and all follow the branch-and-price framework. The two first mentioned approaches also strengthen the obtained lower bound by adding valid inequalities to the LP formulation. The size of the instances that consistently can be solved to optimality is rather limited as unsolved instances with 50 customers exist, but some large-scale instances can be solved. For example, Kallehauge et al. [11] report that a 1000 customer instance has been solved. Solving problems of this size is only possible by current techniques if the instance has a certain structure and the time constraints are very tight. These observations justify the research into heuristics for the VRPTW as industrial routing problems demand robust algorithms for large-sized instances. The CVRP literature is also vast. Classic heuristics for the problem have been surveyed by Laporte and Semet [14] , and metaheuristics have been surveyed by Gendreau et al. [15] and more recently by Cordeau et al. [16] . CVRP heuristics have typically been tested on 14 instances containing between 50 and 199 customers. In the early 1990s very good metaheuristics for the CVRP were developed such as parallel tabu search by Taillard [17] . Most of the solutions to the 14 classic instances found back then have still not been improved. More recently, some larger instances have been introduced containing between 240 and 1200 customers [18]  and  [19] . These new instances seem to have spurred a new interest into metaheuristics for the CVRP as indicated in the survey by Cordeau et al. [16] . Until recently, exact methods for the CVRP were dominated by branch-and-cut methods. One of the best branch-and-cut algorithms for the CVRP was developed by Lysgaard et al. [20] . Recent research results indicate that branch-and-cut-and-price algorithms are a more promising approach as shown by Fukasawa et al. [21] . For the CVRP, the largest problem that has been solved to optimality contains 135 customers. The OVRP is a variant of the CVRP that has received less attention. The problem appears in various distribution problems, in which the vehicle simply stops after the last delivery. The problem was introduced by Sariklis and Powell [22] and they proposed a two-phase cluster first-route second heuristic. Recently, tabu search heuristics were proposed by Fu et al. [23] and Brandão [24] . Tabu search heuristics for the MDVRP have been proposed by Renaud et al. [25] and Cordeau et al. [1] . The last paper deserves special attention as it describes a general heuristic that also solves periodic vehicle routing problems (PVRP) and periodic traveling salesman problems. Earlier, Chao et al. [26] proposed a record-to-record improvement heuristic for the MDVRP.