Password: The Time Dependent Vehicle Routing Problem (TDVRP) consists in optimally routing a fleet of vehicles of fixed capacity when travel times are time dependent, in the sense that the time employed to traverse each given arc, depends on the time of the day the travel starts from its originating node. The optimization method consists in finding solutions that minimize two hierarchical objectives: the number of tours and the total travel time. Optimization of total travel time is a continuous optimization problem that in our approach is solved by discretizing the time space in a suitable number of subspaces. New time dependent local search procedures are also introduced, as well as conditions that guarantee that feasible moves are sought for in constant time. This variant of the classic Vehicle Routing Problem is motivated by the fact that in urban contexts variable traffic conditions play an essential role and can not be ignored in order to perform a realistic optimization. In this paper it is shown that when dealing with time constraints, like hard delivery time windows for customers, the known solutions for the classic case become unfeasible and the degree of unfeasibility increases with the variability of traffic conditions, while if no hard time constraints are present, the classic solutions become suboptimal. Finally an application of the model to a real case is presented. The model is integrated with a robust shortest path algorithm to compute time dependent paths between each customer pairs of the time dependent model. Keywords Vehicle routing ; Time dependent ; Discretization ; Ant colony system 1. Introduction The Vehicle Routing Problem (VRP) has been largely studied because of the importance of mobility in logistic and supply-chains management that relies on road network distribution. Many different variants of this problem have been formulated to provide a suitable application to a variety of real-world cases, with the development of advanced logistic systems and optimization tools. The features that characterize the different variants aim on one hand to take into account the constraints and details of the problem, while on the other to include different aspects of its nature, like its dynamicity, time dependency and/or stochastic aspects. The richness and difficulty of this type of problem, has made the vehicle routing an area of intense investigation. In this paper we focus on the presence of variable traffic conditions on real road networks, like in urban environments, where these conditions can greatly affect the outcomes of the planned schedule. Accounting for variable travel times is particularly relevant when planning in presence of time constraints, such as delivery time windows. Solutions obtained without considering this variability will result in sub-optimality or unfeasibility with respect to these constraints, as it will be shown in the experimental results section. This study is also motivated by the recent developments of real time traffic data acquisition systems. With access to these data, it is possible to include in the model dynamic and updated information, and obtain realistic and improved solutions. The paper is organized as follow: problem formulation and review of the time dependent models; the Multi Ant Colony System is introduced for the classic VRP, and its extension to the time dependent case; the formulation of new time dependent local search procedures and related issues and discussion of issues related to the time dependency; the remainder of the paper is dedicated to computational results and its applications to a real world situation, with the use of real traffic data and integration with a Robust Shortest Path algorithm [1] to deal with realistic graphs representing the urban road network. 2. Problem description In the classic VRP with hard time windows, VRPTW, a fleet of vehicles of uniform capacity is scheduled to visit the given set of N customers, c i , each characterized by a demand q i , a time window tw i  = [ b i ,  e i ], and a service time s i , with routes originating and ending at a depot, whose opening and closing time [ t c ,  t c ] is specified, and a fleet of trucks of uniform capacity C is available. Each delivery can be done no later than the ending time of the customer’s time window, while if the arrival time at the customer’s location is before the beginning of the customer’s time window, the delivery has to wait until the beginning of the time window. The service time, the time necessary to complete the delivery, must have elapsed before it is possible to leave the location for the next delivery. Other assumptions of the problem are: (1) the quantity requested by the customer is to be delivered in a single issue and in full; (2) all tours must originate and end at the depot, within the depot opening time; (3) the total quantity delivered in each tour cannot exceed the truck capacity C . The problem is represented with a directed graph G ( V ,  A ), where V is the set of nodes, representing the customers and the depot, and characterized by a geographical location, and A is the set of oriented arcs connecting pairs of nodes, and representing the roads as straight connections between nodes. A more complex representation will be considered in Section 7 . Traditionally, the optimization algorithm finds first the solution that minimizes the number of tours, and then minimizes the total length, which is given by the sum of the lengths of all tours. In this case the total length coincides with the total traveling time. A slightly modified problem defines for each arc a constant traveling speed, so a more accurate model is obtained, and the total traveling time (instead of the total length) is used as the minimization objective. This is sometimes referred to as the Constant Speed Model. 3. Review of time dependent VRP models The presence of diversified conditions of traffic at different times of the day were first taken into account by Malandraki and Daskin in [2] (for the VRP as well as for the TSP). On each arc a step-function distribution of the travel time was introduced. A mixed integer programming approach and a nearest neighbor heuristic were used in the optimization. Another approach to the time dependent VRP is presented by Ichoua et al. in [3] , where the customers are characterized by soft time windows, that is, if the arrival time at a customer is later than the end of the time window, the cost function (the total travel time here) will be penalized by some amount. The optimization is done with a tabu search heuristic, and it is based on the use of an approximation function to evaluate in constant time the goodness of local search moves. The model is also formulated for a dynamic environment, where not all service requests are known before the start of the optimization. A direct comparison with the model presented in [3] in not possible, because of two main differences in the models: (1) capacity constraints for the trucks are not considered, and (2) the customers time windows are used as a soft constraint. As a consequence of this, in [3] there is no need of an optimization with respect to the number of tours (which is supposed to be known a priori ), and no unfeasible solutions are found. In the TDVRP model, the number of tours is an objective of the optimization, and because of the constraint of the time windows, unfeasible solutions can also be found. Nevertheless in [3] the First In, First Out (FIFO) principle is introduced: if two vehicles leave from the same location for the same destination traveling on the same path, the one that leaves first will always arrive first, no matter how speed changes on the arcs during the travel. This principle is important not only because it prevents some inconsistencies (e.g. a vehicle could wait at some location for the time when speeds are higher and then arrive at the desired location before another vehicle who had left before), but also because, as it will be shown later in this paper, it allows to keep linear the time required to check for the feasibility of local search moves, as in the constant speed/classic VRP case (discussion in Section 6 ). The FIFO principle is guaranteed by using a step function for the speed distribution, from which the travel times are then calculated, instead of a step function for the travel time distribution. A typical speed distribution is shown in Fig. 1 a. In this way, the traveling time distribution (shown in Fig. 1 b) deriving by the speed distribution is continuous, and since the distance between two nodes is fixed, it only depends on the time of the day when the travel starts. Fig. 1. 