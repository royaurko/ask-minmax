Password: We present a mathematical programming model for the combined vehicle routing and scheduling problem with time windows and additional temporal constraints. The temporal constraints allow for imposing pairwise synchronization and pairwise temporal precedence between customer visits, independently of the vehicles. We describe some real world problems where in the literature the temporal constraints are usually remarkably simplified in the solution process, even though these constraints may significantly improve the solution quality and/or usefulness. We also propose an optimization based heuristic to solve real size instances. The results of numerical experiments substantiate the importance of the temporal constraints in the solution approach. We also make a computational study by comparing a direct use of a commercial solver against the proposed heuristic, where the latter approach can find high quality solutions within specific time limits. Keywords Routing ; Scheduling ; Temporal constraints ; Synchronization ; Branch and bound 1. Introduction Combined vehicle routing and scheduling with time windows arises in many applications and there is an extensive and wide research literature on operations research (OR) models and methods, both exact and heuristic. Temporal constraints within a route for one vehicle frequently occurs in well known problems such as the dial-a-ride and the pickup and delivery problems. However, the problem of vehicle dependencies is given much less attention in the literature. A typical application is when two vehicles must meet at a point at the same time or when a vehicle cannot pick up a load until another vehicle has delivered the same load. The main goal of this paper is to develop and test a general mathematical programming model for the combined vehicle routing and scheduling with time windows and additional temporal constraints. The temporal constraints introduced allow for imposing pairwise temporal precedence and pairwise synchronization between customer visits, independently of the vehicles. Given a fleet of vehicles available in a depot and a set of customers to be serviced within their respective prescribed time windows, the objective for the vehicle routing and scheduling problem (VRSP-TW) is for example, to minimize the total traveling time. Both heuristic and exact solution methods have been suggested for solving applications of the VRSP-TW, see, e.g. the survey in Desrosiers et al. (1995) . The VRSP with a single vehicle and precedence constraints is commonly seen as a traveling salesman problem with precedence constraints. Fagerholt and Christiansen (2000) use the single vehicle VRSP-TW with additional allocation constraints to solve a subproblem arising in a ship scheduling application. If we introduce capacity constraints to the VRSP-TW, depending on the precedence constraints, we get a pickup and delivery problem with time windows (PDP-TW) which is an exhaustively studied problem, see, e.g. Desrosiers et al. (1995) . Sigurd et al. (2004) use precedence constraints for an application that arise in live animal transportation. In the pickup and delivery and the dial-a-ride problems, the precedence constraints are limited to precedence within a route for a single vehicle. A related problem is the job shop scheduling problem (JSP), where each job is defined by a set of ordered activities and each activity is normally to be executed on one predefined resource. All activities for one job are not bound to one resource and the precedence constraints therefore span over multiple resources, as opposed to the pickup and delivery and the dial-a-ride problems. Beck et al. (2003) study the differences between VRP and JSP and apply both vehicle routing and scheduling techniques to VRPs. In their study, they include vehicle independent precedence constraints to the VRP and observe that the routing techniques they use have difficulties in finding feasible solutions, while the scheduling techniques find feasible solutions to all the studied problem instances. Gélinas and Soumis (2005) use decomposition techniques to solve large scale JSP problems. They obtain tighter LP relaxation by using TSP-TW as subproblem for the schedule on one machine instead of the SPP-TW used for VRP-TW problems. In the combined vehicle and crew scheduling problem for urban mass transit systems, drivers are allowed to change bus in so called relief points. Commonly, as seen in Haase et al. (2001) and the work of Freling et al. (2003) , the arrival time at a relief point is defined by a timetable and therefore the synchronized arrival of bus drivers is implicitly considered. In the homecare scheduling problem presented in Eveborn et al. (2006) , there is a required synchronization of staff visits to customers (such as elderly people). The model for the periodic routing and airline fleet assignment problem, presented in the paper by Ioachim et al. (1999) , has temporal constraints that define the same departure time for pairs of flights, which is a set of synchronization constraints in the sense that we use in this paper. For their problem they develop a multi-commodity flow formulation and a solution method based on a side constrained set partitioning reformulation, which they solve with column generation in a branch-and-bound framework. The solution process is further developed in Bélanger et al. (2006) where characteristics of the subproblem are used. In this paper, we want to emphasize the importance of the temporal synchronization and precedence constraints found in several real world applications. For this purpose, we suggest a straight-forward model of the VRSP-TW and extend it with the introduced constraints. The main contributions of the paper are as follows. The proposed model is a generalization of the VRSP-TW. Using standard VRSP-TW some strict simplification of the problem must be enforced to handle the synchronization constraints. A standard approach is to put a strict limit on the time windows providing a simplified VRP problem. A model that considers some synchronization constraints for an airline fleet assignment and routing is given in Ioachim et al. (1999) . Our model however, is more general and is based on an extension of a traditional VRP model. We also demonstrate through the computational experiments that our proposed model is not significantly harder to solve compared to a VRSP-TW model without synchronization constraints. We also demonstrate the potential improvements in handling the constraints explicitly in the model. We propose an optimization based heuristic that finds high quality solutions within specific time limits. We do not suggest that this model should be used directly to solve all applications. It does however, describe the temporal constraints clearly. It can also be used as a basis for formulating and developing more application oriented models and solution methods. The outline of this paper is as follows. In Section 2 we describe the problem and demonstrate it with an illustrative example. In this section we also describe some typical applications where precedence and synchronization constraints are important aspects. In Section 3 we present the new model. We focus on constraints that relate to at least two vehicles. We do not study the case when two jobs are done by the same vehicle such as in dial-a-ride and pickup and delivery. This is easy to include but does not add anything to the model. In Section 4 we describe the numerical tests performed. This includes a description of the test problems, a description of the heuristic developed and analyses of the tests. Finally, we make some concluding remarks and outline some further work in Section 5 .