Password: In this paper, we study an extension of the PVRP where the vehicles can renew their capacity at some intermediate facilities. Each vehicle returns to the depot only when its work shift is over. For this problem we propose a tabu search (TS) algorithm and present computational results on a set of randomly generated instances and on a set of PVRP instances taken from the literature. Keywords Periodic vehicle routing ; Intermediate facilities ; Renewable capacity ; Heuristics ; Tabu search 1. Introduction In the periodic vehicle routing problem (PVRP) a set of customers have to be visited, one or several times, on a given time horizon. The set of dates in which a vehicle serves a customer is not fixed a priori, but instead, a list of possible sets of dates (visiting schedules) is associated with each customer. A fleet of vehicles is available and each vehicle leaves the depot, serves a set of customers and, when its work shift or its capacity is over, returns to the depot. The objective of the problem is the minimization of the total length of the routes travelled by the vehicles on the time horizon. Solving the problem requires assigning a visiting schedule to each customer and, for each day of the time horizon, defining the routes of the vehicles in such a way that all the customers, whose assigned schedule includes that day, are served. This model is a periodic version of the classical vehicle routing problem and the periodic characteristic of the PVRP is essential in various applications. For instance, in waste collection problems, each customer has to be typically served with a given periodicity, say once a week, and the working days include all the days of a week, except Sunday. In this case the list of visiting schedules is such that each schedule includes one of the working days of the week. Unfortunately, the routing problems in waste collection applications cannot typically be modelled with the PVRP, due to the presence of the waste treatment plants. The vehicles return to the depot only when the work shift is over. When the capacity limit is reached the vehicles renew their capacity by unloading the waste at one of the treatment plants. In the case of distribution problems, an intermediate facility may be a warehouse where the goods are stored and where a vehicle loads the goods any time it starts a new route. In this paper, we present a generalization of the PVRP in which some intermediate facilities exist where the vehicles renew completely their capacity. Each vehicle can renew its capacity at possibly different intermediate facilities and returns to the depot only when the work shift is over. The objective of the problem is the minimization of the total length of the routes travelled by the vehicles. We propose a tabu search (TS) heuristic for the solution of the PVRP with intermediate facilities (PVRP-IF). We test different versions of the algorithm on PVRP instances taken from the literature and on randomly generated instances. The paper is organized as follows. In the rest of this section, we discuss the related literature. In Section 2 , we define a model for the problem. In Section 3 , we present the solution algorithm and in Section 4 we report the results obtained when the algorithm is run on PVRP instances taken from the literature and on new random instances specific for the problem. 1.1. Literature Early formulations of the PVRP were developed by Beltrami and Bodin [2] and by Russell and Igo [15] who proposed heuristics applied to waste collection problems. The problem we discuss in this paper is a generalization of the PVRP as stated, among others, in Christofides and Beasley [5] and Cordeau et al. [6] . A number of papers on the PVRP exists in the literature. Christofides and Beasley [5] present a heuristic that assigns a priority level to each customer and, according to this priority, assigns a visiting schedule to each customer so that the increase of an estimation of the costs of the vehicle routing problems (VRPs) related to the schedules is minimized. Then, an improving phase follows where an attempt is made to decrease the estimation of the VRPs by changing the visiting schedules of the customers. Finally, a VRP is solved for every day. Tan and Beasley [17] use the idea of the generalized assignment method proposed by Fisher and Jaikumar [8] and assign a visiting schedule to each vertex. Eventually a heuristic for the VRP is applied to each day. Russell and Gribbin [14] develop a heuristic organized in four phases. Chao et al. [4] combine a number of techniques to assign visiting schedules, build and improve routes and re-initialize the optimization process. In particular they relax the capacity constraints in order to give more freedom to the minimization of routes during the construction phase. Cordeau et al. [6] present an algorithm that is, to our knowledge, the best heuristic for the PVRP so far developed. The solution algorithm is a TS heuristic which, differently from the above heuristics, may allow infeasible solutions during the search process. Infeasibility is allowed only with respect to capacity of vehicles and duration of routes. The algorithm adopts a “sweep” technique to calculate the initial solution, moves to a solution which minimizes a penalized cost function and iterates. The penalized cost depends on possible violation of capacity and time constraints and on the frequency of repeated moves. The algorithm implements two kinds of moves: move a customer from a route to another route in the same day, and change the schedule of a customer. A heuristic for a variant of the PVRP, where the objective is to minimize the number of vehicles, is proposed by Gaudioso and Paletta [9] . 2. Model formulation In this section, we briefly recall the basic elements of the vehicle routing and the PVRP. Then we present the PVRP with intermediate facilities. 2.1. The vehicle routing and the periodic vehicle routing problems The basic version of the VRP is defined on a graph G =( V , A ), where V ={ v 0 , v 1 ,…, v n } is the set of vertices and A ⊂ V × V is the set of arcs. The vertex v 0 corresponds to the depot. A set of m vehicles is available where each vehicle has a capacity Q i , i =1,…, m (vehicles may be identical). Every other vertex v i corresponds to a customer whose demand q i is known. A cost, or distance, c ij is associated with each arc ( v i , v j )∈ A . If there is no arc connecting a pair ( v i , v j ) the corresponding cost is set to infinity. The objective is to define m routes on graph G , one per vehicle, so that the global cost, or length, of the routes is minimized. A feasible solution is such that every route starts and ends at the depot v 0 , each customer is assigned to one and only one route and the load of each vehicle does not exceed the vehicle capacity. Variants of the above formulation have been studied. If a time window is assigned to each customer, the time windows VRP is obtained. Another generalization of the VRP is the multi-depot VRP in which there is more than one depot and each vehicle starts and ends its route at the depot to which it is assigned. We refer to [3] , [7]  and  [11] for surveys on VRP and to [12]  and  [13] for bibliographies. All the variants of the classical VRP aim at planning the routes of a fleet of vehicles for a single time instant, say a day. The demand of the customers is defined for one day only. Situations where the day in which each customer has to be served is fixed can be modelled with VRP as, for each day, a VRP has to be solved. A different multi-day model is required when there is the possibility of choosing when to serve a customer. The PVRP is such a model. A T days horizon and a list of feasible visiting schedules for each customer are given (the customer's demand is specified for each day of any possible visiting schedule). Each customer must be assigned one and only one feasible visiting schedule according to which it has to be visited and then, for each day of the planning horizon, a VRP has to be solved. Obviously, the choice of the visiting schedules and the definition of the routes are interrelated problems. The objective of the PVRP is the minimization of the global length of the routes. In the PVRP formulated, for instance, by Cordeau et al. [6] , in addition to the classical characteristics of the VRP, a service time is given for each customer and a travelling time is given for each arc, together with a maximum duration of a route (work shift). 2.2. The PVRP with intermediate facilities The PVRP-IF is a generalization of the PVRP, where a set of intermediate facilities are introduced to serve as loading or unloading facilities. In the case of a distribution problem, the intermediate facilities represent the warehouses where the goods are stored. A vehicle, which is empty when leaving the depot, goes directly to an intermediate facility for loading the goods, serves a set of customers, may return to a facility for the loading and returns to the depot only when the work shift is over. Let us note that no customer is allowed on the way from the depot to the first facility because the vehicle is empty. In the case of a collection problem, the intermediate facilities represent the sites where the vehicles are unloaded. A vehicle leaves the depot and starts collecting the goods from the customers. When the vehicle is full, it reaches an intermediate facility for the unloading operation, then it may start for another collection tour and returns to the depot when the work shift is over. In case of a collection problem, differently from the distribution problem, customers are allowed on the path from the depot to the first facility, but are not on the path from the last facility to the depot. In this paper, we describe a model for a collection problem. However, the model can be easily applied to a distribution problem as follows. First of all, the matrix of the distances and the matrix of the travelling times of the distribution problem have to be transposed. Then we can apply the model for the collection problem interpreting the demand of a customer as the quantity to be collected. Finally, when a solution for the collection problem is found, the orientation of all the arcs in the solution has to be reversed. The solution obtained in this way is the solution of the original distribution problem.