Password: In this paper, we present an effective memetic algorithm for the vehicle routing problem with time windows (VRPTW). The paper builds upon an existing edge assembly crossover (EAX) developed for the capacitated VRP. The adjustments of the EAX operator and the introduction of a novel penalty function to eliminate violations of the time window constraint as well as the capacity constraint from offspring solutions generated by the EAX operator have proven essential to the heuristic's performance. Experimental results on Solomon's and Gehring and Homberger benchmarks demonstrate that our algorithm outperforms previous approaches and is able to improve 184 best-known solutions out of 356 instances. Keywords Vehicle routing ; Time windows ; Memetic algorithm ; Penalty function 1. Introduction The vehicle routing problem with time windows (VRPTW) is one of the most important and widely studied NP-hard combinatorial optimization problems in the operations research literature. The VRPTW can be described as the problem of determining a least cost routing plan to deliver goods from a single depot to a set of geographically scattered customers. The routing plan must be designed in such a way that each customer is visited exactly once by a single vehicle departing from and returning to the depot, the total of goods loaded in any vehicle must not exceed a vehicle capacity (capacity constraint), and each customer must be serviced with a given time interval (time window constraint). The latter constraint defines the VRPTW as a variant of the standard or capacitated VRP (CVRP). A common objective of the VRPTW is to minimize total travel distance, but a hierarchical objective of minimizing the number of routes (primary objective) and the total travel distance (secondary objective) is also frequently used. The VRPTW provides the mathematical basis of many distribution management problems encountered in practice, ranging from route design for parcel deliveries in various industries, cash deliveries to banks and ATM terminals, school bus routing and so on, to more tactical and strategic decision support tools in which routing decisions are combined with fleet composition, inventory or warehouse location etc. Apart from its practical importance, the standard VRPTW is a challenging optimization problem of significant academic value as it is often used as a benchmark problem when new solution approaches are suggested for less-studied or novel VRPTW variants. Given its practical and academic importance, intensive research efforts have been directed towards the development of both exact and heuristic algorithms for the VRPTW and its variants. For an extensive review, the reader is referred to Cordeau et al. [1] , Bräysy and Gendreau [2]  and  [3] , and Golden et al. [4] . Most of exact and heuristic algorithms have been applied to the well-known benchmark problems of Solomon (100 customers) [10] and of Gehring and Homberger (200–1000 customers) [11] to compare their performance. Here we refer only to the recent exact and heuristic algorithms that have shown the best performance on these benchmarks according to the literature. The current state of the art exact algorithms are proposed by Chabrier [7] , Irnich and Villeneuve [8] , Jepsen et al. [5]  and  [6] and Kallehauge et al. [9] . For exact approaches, the single objective of minimizing the total travel distance is considered by tradition. Up to the present date, 45 instances out of 56 in Solomon's benchmarks have been solved to optimality [5] . However, it sometimes needs more than 5 h to solve non-structured instances whereas some instances having a certain structure and/or very tight time windows can be solved within a minute. For larger instances in the Gehring and Homberger benchmarks consisting 300 instances, only seven 200-customer instances, one 400-customer instance and one 1000-customer instance have been solved to optimality [9] . Here, one should note that these instances have a specific structure and/or very tight time windows and thus instances of this size can only be solved under certain conditions. The current state-of-the-art heuristics for the VRPTW consist of evolution strategies [12]  and  [13] , large neighborhood searches [14] , [15]  and  [16] , iterated local searches [17]  and  [18] , and multi-start local searches [17]  and  [19] . Here one should note that the hierarchical objective is considered in these methods and that most of heuristic methods consider this objective by tradition. Given the hierarchical objective, the state-of-the-art heuristics are all based on a two-stage approach [32]  and  [14] where the number of routes is minimized in the first stage and the total travel distance is then minimized in the second stage. This two-stage approach allows us to independently develop algorithms for the route minimization and for the distance minimization. Therefore, developing powerful algorithms either for route minimization or for distance minimization is also justified because they can be used as a basis for new metaheuristic approaches based on the two-stage approach. In this paper, we develop a penalty-based memetic algorithm for the VRPTW by extending the edge assembly memetic algorithm (EAMA) of Nagata [20] for the capacitated VRP (CVRP). As such, the suggested solution approach belongs to the class of memetic algorithms (MAs) [21] . MA is a population-based heuristic search approach that combines evolutionary algorithm (EA) for the global, more distant search (exploration), with local search algorithm to organize a more intensive local search (exploitation). For this reason, MAs are often referred to as hybrid genetic algorithms or genetic local searches. The suggested EAMA is based on the two-stage approach. An initial population of solutions, each consisting of the same number of routes, is generated with a sophisticated route-minimization procedure developed by Nagata and Bräysy [22] . A subsequent procedure of the EAMA is then applied for minimizing total travel distance for the determined number of routes. Main contributions of this paper are (i) the adaptation of the EAX to the VRPTW and (ii) the development of a novel penalty function for the time window violation. In the earlier research [20] the edge assembly crossover (EAX) [23] , [24]  and  [25] , for the traveling salesman problem (TSP), was adapted to the CVRP. In this paper, we further adapt the EAX to the VRPTW by incorporating features to handle the time window constraint. In MAs, it is frequently very hard to generate feasible offspring solutions, i.e. solutions satisfying both the capacity and time window constraints, immediately after invoking the crossover and mutation operators. Therefore, temporarily allowing infeasible intermediate solutions during the search process in MAs makes sense. In fact, it is a well-known concept in metaheuristic search and often penalty functions are introduced to direct the search towards feasible solutions, see e.g. Gendreau et al. [26] and Toth and Vigo [27] for the literature on the CVRP and Badeau et al. [28] , Berger and Barkoui [29] , Bouthillier et al. [30] , Ibaraki et al. [17]  and  [18] for the literature on the VRPTW. However, for n n customers in the affected routes, it takes O(n) O ( n ) time to compute the penalty of the time window violation defined in the previous works when traditional neighborhood operators are applied. In this paper, we suggest a novel penalty function, which can be computed in O(1) O ( 1 ) time for most traditional neighborhood operators, to efficiently handle the time window violation as well as the capacity violation.