The rigid to floppy transitions and the associated intermediate phase in
glasses are studied in the case where the local structure is not fully
determined from the macroscopic concentration. The approach uses size
increasing cluster approximations and constraint counting algorithms. It is
shown that the location and the width of the intermediate phase and the
corresponding structural, mechanical and energetical properties of the network
depend crucially on the way local structures are selected at a given
concentration. The broadening of the intermediate phase is obtained for
networks combining a large amount of flexible local structural units and a high
rate of medium range order.