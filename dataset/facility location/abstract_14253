Simplified models of the dynamics such as the linear inverted pendulum model
(LIPM) have proven to perform well for biped walking on flat ground. However,
for more complex tasks the assumptions of these models can become limiting. For
example, the LIPM does not allow for the control of contact forces
independently, is limited to co-planar contacts and assumes that the angular
momentum is zero. In this paper, we propose to use the full momentum equations
of a humanoid robot in a trajectory optimization framework to plan its center
of mass, linear and angular momentum trajectories. The model also allows for
planning desired contact forces for each end-effector in arbitrary contact
locations. We extend our previous results on LQR design for momentum control by
computing the (linearized) optimal momentum feedback law in a receding horizon
fashion. The resulting desired momentum and the associated feedback law are
then used in a hierarchical whole body control approach. Simulation experiments
show that the approach is computationally fast and is able to generate plans
for locomotion on complex terrains while demonstrating good tracking
performance for the full humanoid control.