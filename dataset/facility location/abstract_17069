Recent detections of GeV photons in a few GRBs by Fermi-LAT have led to
strong constraints on the bulk Lorentz factor in GRB outflows. To avoid a large
gamma-gamma optical depth, minimum values of the Lorentz factor have been
estimated to be as high as 800-1200 in some bursts. Here we present a detailed
calculation of the gamma-gamma optical depth taking into account both the
geometry and the dynamics of the jet. In the framework of the internal shock
model, we compute lightcurves in different energy bands and the corresponding
spectrum and we show how the limits on the Lorentz factor can be significantly
lowered compared to previous estimates. Our detailed model of the propagation
of high energy photons in GRB outflows is also appropriate to study many other
consequences of gamma-gamma annihilation in GRBs: (i) the gamma-gamma cutoff
transition in a time-integrated spectrum is expected to be closer to a
power-law steepening of the spectrum than to a sharp exponential decay; (ii)
the temporal evolution of the gamma-gamma opacity during a burst favors a delay
between the MeV and GeV light curves; (iii) for complex GRBs, the gamma-gamma
opacity suppresses the shortest time-scale features in high energy light curves
(above 100 MeV). Finally we also consider GRB scenarii where MeV and GeV
photons are not produced at the same location, showing that the gamma-gamma
opacity could be further lowered, reducing even more the constraint on the
minimum Lorentz factor.