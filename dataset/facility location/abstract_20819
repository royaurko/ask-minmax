Password: This paper proposes a mixed integer linear program (MILP) for the design and planning of a production–distribution system. This study aims to help strategic and tactical decisions: opening, closing or enlargement of facilities, supplier selection, flows along the supply chain. These decisions are dynamic, i.e. the value of the decision variables may change within the planning horizon. The model considers a multi-echelon, multi-commodity production–distribution network with deterministic demands. We present one application: how to plan the expansion of a company that has to face increasing demands. We report numerical experiments with an MILP solver. Keywords Supply chain design ; Facility location ; Strategic planning ; Dynamic model ; Mixed integer linear programming 0. Introduction Locating facilities, designing the supply chain, selecting suppliers, defining the physical and information flows along a supply chain are critical parts of corporate strategic planning. These long-term decisions influence the activities of the company, and require a deep knowledge of the company and its environment. Companies can be faced with facility location and supply chain design problems in different situations. Let us mention a few examples: • A company that extends its activity to new geographical areas has to locate facilities and design a new part of its supply chain. • When the activity approaches the limits of the production capacity, the choice between opening new facilities or enlarging existing ones is a real strategic issue. • In the case of an obsolete facility, is it better to renovate it or close it and replace it by a new one? • When demand is declining, restructuring the supply chain involves choosing where the activity should be reduced. • The merger of two companies involves merging the supply chains too. All of these examples underline the importance of long-term planning in supply chain design. The objective of this paper is to propose a mathematical model for designing and optimising a supply chain over a multi-period horizon. The model includes important features such as the location of several types of facilities, supplier selection, multiple finished goods with their respective bills of materials, fixed and variable costs. Human and organisational factors are beyond the scope of the present paper which only models the quantitative aspects of the problems. Our purpose is to provide managers with quantitative tools for decision-making, but any real-life decision process should consider both qualitative and quantitative information. The paper is organised as follows. A literature review is presented in Section 1 while the mathematical model is defined in Section 2 . Computational results are reported in Section 3 . Some discussion and further research are presented in the conclusion. 1. Problem context and related studies 1.1. Facility location and supply chain design Facility location and strategic planning have been the subject of a considerable number of publications in the fields of management science and operational research. The first researches focused on single facility and then on multiple facility location. New constraints were appended to the existing models, in order to yield more realistic ones. During the previous decade, many works have addressed the dynamic location problem. In this class of problems, the decisions are spread out over a long-term planning horizon, and the decision variables are time-dependent. The purpose is to minimise or maximise an objective function over this horizon. For example, how should a growing company develop its logistic system in the five forthcoming years so that the demand and the logistic constraints remain satisfied at a minimum cost? Dynamic location problems were first described in a single facility location context. In the first paper in this field ( Ballou, 1968 ), the objective was to locate one warehouse in order to maximise profits over a finite planning horizon. The author solves a series of static location problems (one for each time period) and then resorts to dynamic programming. The problem was extended to multiple facilities by Scott (1971) . There is such a large variety of company logistic networks that it seems unrealistic to build a completely generic model that would adapt to any organisation. The most recent models include many additional features, with the idea of reflecting some real cases or of focusing on some precise aspects of location problems. However, no published paper integrates all the possible features simultaneously. Among the main characteristics in the recent models, we can list the following: • Supply chain with multiple echelons: suppliers, plants, warehouses, customers, etc. • Multiple products or families of products. • Complex product flows: several layers of plants and warehouses. exchange of products between plants or warehouses, direct deliveries to some customers, reverse logistics, re-manufacturing, etc. • Choice between several transportation modes, several production technologies. • Variety of constraints: capacity constraints, budget constraints, etc. • Complex structure of the costs: fixed and variable costs, linear or nonlinear costs. • Hybrid strategic/tactical models with inventories: average inventory, safety stock, cyclic inventories. Our assumptions and selected features are detailed in Section 2 . 1.2. Literature review Instead of reviewing all the related works, we present five papers that helped us to build our own model, and that cover the main characteristics of location problems. For a detailed review of the field, interested readers should refer to the following: Daskin et al. (2005) propose an extensive review of location problems, Beamon (1998) distinguishes models with deterministic data from those with stochastic data, Owen and Daskin (1998) clearly separate the static and dynamic models. Cordeau et al. (2006) propose a static model considering a multi-commodity, multi-facility and single-country network. The decision variables concern the number of locations, the capacity and technology of manufacturing in plants and warehouses, selection of suppliers, selection of distribution channels, transportation modes and material flows. Bills of materials are also taken into consideration. To solve this problem, the authors present two methods: a simplex-based branch-and-bound approach and a Benders decomposition approach. They use some valid inequalities to strengthen the LP relaxation. In our formulation, we take a similar structure network but put the model in a multi-period horizon. Hamer-Lavoie and Cordeau (2006) simplify this model by removing the suppliers and the bills of materials. They suppose that the location has already been chosen for plants and the model focuses on warehouse location. The model is dynamic with stochastic demands, and takes inventories into account, including the safety stock. The authors propose a linear approximation for the last constraints concerning safety stock and a branch-and-bound method strengthened by valid inequalities. The main contributions of this paper are the introduction of stochastic demands and safety stock management. Dias et al. (2006) work on the re-engineering of a two-echelon network (facilities and customers). The authors suppose that facilities can be opened, closed and reopened more than once during the planning horizon. They study these conditions within three scenarios: with maximum capacity restrictions; with both maximum and minimum capacity restrictions; and with a maximum capacity that decreases. All of these problems are solved by primal-dual heuristics. In this paper, three linear formulations correspond to the three previous scenarios and their linear dual formulations are presented. The main characteristic of this model is its great flexibility. The idea that we have taken from this paper is the possibility of opening and closing a facility during the planning horizon. Nevertheless, we forbid a closed facility to be reopened. With the same flexibility idea, Melo et al. (2006) aim at relocating the network with expansion/reduction capacity scenarios. Capacity can be exchanged between an existing facility and a new one, or between two existing facilities under some conditions. Each change of capacity is penalised by a cost. In this model, closed facilities cannot be reopened, and new facilities will remain in activity until the end of the planning horizon. Some budget constraints are also added, which is rare in the literature. This proposition suggested to us the introduction of the modular capacity for each facility. Vila et al. (2006) propose a dynamic model in a much more specialised context. They consider an application in the lumber industry, but their model can be applied to other sectors. The authors consider an international network, with deterministic demands. They consider external suppliers, capacitated plants and warehouses, the choice between a set of available technologies, the possibility of adding capacity options to the facilities, and a list of substitute products to replace standard ones. They define three levels of storage. Their objective function is the after-tax profit, which has to be maximised. 1.3. Summary To complement the presentation of the most relevant papers in this field, Table 1 sums up the characteristics of 15 models from the literature of the last decade. The first four references concern static models while the last eleven are dynamic. Refs. [1–9] deal with only the strategic level and do not handle inventories, whereas the last six cover both strategic and tactical decision levels. Modular capacities mean that the capacities may vary, due for example to supplementary options of capacity that may be added to the existing facilities. In the column Closing/reopening, we do not distinguish models that authorise or forbid the reopening of a facility after closure. Resolution methods for each model are reported in Table 2 . We classify these methods in four categories: exact methods, commercial solvers, heuristic methods and metaheuristics.