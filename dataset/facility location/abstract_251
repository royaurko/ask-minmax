We consider the problem of designing mechanisms that interact with strategic
agents through strategic intermediaries (or mediators), and investigate the
cost to society due to the mediators' strategic behavior. Selfish agents with
private information are each associated with exactly one strategic mediator,
and can interact with the mechanism exclusively through that mediator. Each
mediator aims to optimize the combined utility of his agents, while the
mechanism aims to optimize the combined utility of all agents. We focus on the
problem of facility location on a metric induced by a publicly known tree. With
non-strategic mediators, there is a dominant strategy mechanism that is
optimal. We show that when both agents and mediators act strategically, there
is no dominant strategy mechanism that achieves any approximation. We, thus,
slightly relax the incentive constraints, and define the notion of a two-sided
incentive compatible mechanism. We show that the $3$-competitive deterministic
mechanism suggested by Procaccia and Tennenholtz (2013) and Dekel et al. (2010)
for lines extends naturally to trees, and is still $3$-competitive as well as
two-sided incentive compatible. This is essentially the best possible. We then
show that by allowing randomization one can construct a $2$-competitive
randomized mechanism that is two-sided incentive compatible, and this is also
essentially tight. This result also closes a gap left in the work of Procaccia
and Tennenholtz (2013) and Lu et al. (2009) for the simpler problem of
designing strategy-proof mechanisms for weighted agents with no mediators on a
line, while extending to the more general model of trees. We also investigate a
further generalization of the above setting where there are multiple levels of
mediators.