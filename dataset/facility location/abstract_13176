Two-sample tests for multivariate data and especially for non-Euclidean data
are not well explored. This paper presents a novel test statistic based on a
similarity graph constructed on the pooled observations from the two samples.
It can be applied to multivariate data and non-Euclidean data as long as a
dissimilarity measure on the sample space can be defined, which can usually be
provided by domain experts. Existing tests based on a similarity graph lack
power either for location or for scale alternatives. The new test utilizes a
common pattern that was overlooked previously, and works for both types of
alternatives. The test exhibits substantial power gains in simulation studies.
Its asymptotic permutation null distribution is derived and shown to work well
under finite samples, facilitating its application to large data sets. The new
test is illustrated on two applications: The assessment of covariate balance in
a matched observational study, and the comparison of network data under
different conditions.