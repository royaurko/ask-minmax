The Aquarius project is the first simulation that can resolve the full mass
range of potential globular cluster formation sites. With a particle mass
$m_\mathrm{p}=1.4 \times 10^4$\Msun, Aquarius yields more than 100 million
particles within the virial radius of the central halo which has a mass of $1.8
\times 10^{12}$\Msun, similar to that of the Milky Way. With this particle
mass, dark matter concentrations (haloes) as small as 10$^6$ M$_\odot$ will
contain a minimum of 100 particles.Here, we use this simulation to test a model
of metal-poor globular cluster formation based on collapse physics. In our
model, globular clusters form when the virial temperatures of haloes first
exceed $10^4$ K as this is when electronic transitions allow the gas to cool
efficiently. We calculate the ionising flux from the stars in these first
clusters and stop the formation of new clusters when all the baryonic gas of
the galaxy is ionised. This is achieved by adopting reasonable values for the
star formation efficiencies and escape fraction of ionising photons. The model
is successful in that it predicts ages (peak age $\sim$ 13.3 Gyrs) and a
spatial distribution of metal-poor globular clusters which are consistent with
the observed populations in the Milky Way. We then test a scenario of
metal-rich cluster formation by examining mergers that trigger star formation
within central gas disks. This results in younger ($\sim$ 7--13.3 Gyrs), more
centrally-located clusters (40 metal-rich GCs within 18 kpc from the centre of
the host) which are consistent with the Galactic metal-rich population. We test
an alternate model in which metal-rich globular clusters form in dwarf galaxies
that become stripped as they merge with the main halo. We find that this
process is inconsistent with observed metal-rich globulars.