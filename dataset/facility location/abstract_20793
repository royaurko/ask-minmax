Password: Facility location problems are often encountered in many areas such as distribution, transportation and telecommunication. We describe a new solution approach for the capacitated facility location problem in which each customer is served by a single facility. An important class of heuristic solution methods for these problems are Lagrangian heuristics which have been shown to produce high quality solutions and at the same time be quite robust. A primal heuristic, based on a repeated matching algorithm which essentially solves a series of matching problems until certain convergence criteria are satisfied, is incorporated into the Lagrangian heuristic. Finally, a branch-and-bound method, based on the Lagrangian heuristic is developed, and compared computationally to the commercial code CPLEX. The computational results indicate that the proposed method is very efficient. Keywords Branch-and-bound ; Integer programming ; Facility location ; Lagrangian heuristics 1. Introduction and problem formulation Facility location models are used in many areas such as distribution, transportation and telecommunication. These models have received a great deal of attention in the research literature. Given a set of potential locations for facilities and a set of customers, the facility location problem is to locate facilities in such a way that the total cost for assigning facilities and satisfying the demand of customers is minimized. The facility location problem can be classified into different categories depending on the restrictions assumed. In the uncapacitated facility location problem each facility is assumed to have no limits on its capacity. In that case, each customer receives all required demand from one facility. When each facility has a limited capacity the problem is called the capacitated facility location problem. The Single-Source Capacitated Facility Location (SSCFL) problem is a special case of the capacitated facility location problem in which each customer can only be supplied from one facility. To formulate the mathematical model for the SSCFL problem we introduce the following notation. Let m be the number of potential facilities, n the number of customers, a j the demand of customer j , b i the capacity of facility i , f i the fixed cost for using/opening facility i , and c ij the cost for assigning customer j to facility i . All coefficients are assumed to be nonnegative and integral. We define the following decision variables: The problem can then be stated by the following integer program: The objective function is to minimize the cost of assigning customers to open facilities and the cost of establishing such facilities. Constraint set (1) can be referred to as the capacity constraints (or the facility constraints), and ensures that the customer demand served by a certain facility does not exceed its capacity. Constraint set (2) can be referred to as the demand constraints (or the customer constraints), and ensures that each customer is assigned to exactly one facility and constraint set (3) ensures that the assignments are made only to open facilities. Constraint set (3) is redundant in (P), but the LP-relaxation of (P) is strengthened considerably (i.e. gets a higher optimal objective function value) by its inclusion. In this model all variables are binary. Within the area of telecommunications, location problems occur in many different circumstances. One important class of applications is when equipment of different kinds is to be installed, it could be concentrators (as in Pirkul, 1987 ) or other end equipment for optical fibers. The units to locate can be of very different sizes, from small electronic equipment to switching cabinets and exchange buildings. Often the situation is actually more complicated, but the location model captures the most essential parts of the problem, and is thus a sufficiently good approximation. The units (facilities) to be installed are almost always capacitated, and the single sourcing property is also quite usual, i.e. the demand unit (the “customer”) is connected to only one facility. One of the most successful approaches for solving the SSCFL problem is to use a so-called Lagrangian heuristic. These heuristics are based on a Lagrangian relaxation and solving the related Lagrangian dual problem, by solving a sequence of smaller and simpler subproblems. To ensure the construction of feasible solutions some heuristic procedure must be adopted, which, given a subproblem solution and/or the dual solution, attempts to generate a feasible solution. Klincewicz and Luss (1986) present an algorithm that is based on relaxing the constraints on the facility capacities. The corresponding Lagrangian subproblems then become uncapacitated facility location problems. Pirkul (1987) , Barcelo and Casanovas (1984) and Sridharan (1993) develop algorithms based upon relaxing the customer assignment constraints. By this relaxation a number of knapsack problems are constructed in each iteration. Beasley (1993) presents a relaxation of both the capacity constraints and the customer assignment constraints. Beasley also gives a comprehensive comparison between various Lagrangian heuristics to facility location problems. For the problem considered in this paper, Beasley found that the approach developed by Pirkul (1987) provides the best feasible solutions, followed by Beasley (1993) , and then Klincewicz and Luss (1986) . This conclusion is corroborated in Åhlander (1994) , where different Lagrangian heuristics for the SSCFL problem are compared. Repeated matching has previously been used to obtain heuristic solutions to several routing and scheduling problems. The term repeated matching is used to describe the solving of a succession of related matching problems. The solution to one problem generates a new matching problem, and the sequence of problems typically terminates when the optimal matching leaves all elements unmatched. It has been used by Forbes (1992) in bus crew scheduling, and by Desrochers and Verhoog (1991) on the fleet size and mix vehicle routing problem. Altinkemer and Gavish (1991) and Wark and Holt (1994) use it as the basis for solving vehicle routing problems. It has also been used in air crew scheduling by Wark et al. (1997) . Attempts to use it as a solution procedure for SSFLC is presented in Rönnqvist (1995) . In this paper, we propose a solution procedure based on a Lagrangian heuristic (using subgradient optimization), a strong primal heuristic (using repeated matching) and branch-and-bound. Specifically we combine a strong dual approach (the Lagrangian dual) with a strong primal (the repeated matching heuristic). The dual scheme generates lower bounds and the primal scheme generates feasible solutions and upper bounds. The solutions from the Lagrangian subproblems act as initial solutions for the primal heuristic. The branch-and-bound procedure utilizes information easily obtainable from the Lagrangian relaxation to speed up the bounding process. Section 2 is devoted to the Lagrangian heuristic. The concept of repeated matching and how it can be adopted for the problem is then described in Section 3 . In Section 4 the branch-and-bound framework is described. Solving the problem with the state-of-the-art commercial code CPLEX is discussed in Section 6 . In Section 7 we present the computational results and in Section 8 we make some conclusions. 2. The Lagrangian heuristic The Lagrangian heuristic consists of the following parts. A Lagrangian relaxation yields lower bounds on the optimal objective function value, but rarely feasible solutions. A subgradient procedure is used to solve the Lagrangian dual, yielding improvements of the lower bounds. A primal heuristic is used for finding primal feasible solutions, yielding upper bounds. Below we describe each of these components. 2.1. Lagrangian relaxation Lagrangian relaxation can be applied to the SSCFL problem in various ways. In Åhlander (1994) a computational comparison of different relaxations is made. The following three approaches were investigated. 1. Relaxation of constraint set (1). The subproblem obtained is an uncapacitated facility location problem, which can be efficiently solved with the method of Erlenkotter (1978) . 2. Relaxation of constraint set (2). The subproblem obtained separates into m knapsack problems, one for each facility, which can be solved by a knapsack code found in Martello and Toth (1990) . 3. Relaxation of constraint set (3) and removal of the y -variables from constraint set (1). The subproblem obtained separates into one trivial problem in y and a generalized assignment problem on x . The latter is a quite difficult problem, but can be solved with a method found in Martello and Toth (1990) . Lagrangian heuristics with quite straightforward primal heuristics were implemented and tested on problems of the size m =50 and n =500. The results of the comparison in Åhlander (1994) are that the second approach seems to be most efficient, the third approach not quite as efficient, while the first approach is clearly inferior. Even though the tests in Åhlander (1994) may be considered as fairly preliminary, the same conclusion is obtained in Beasley (1993) . Therefore we have chosen to use the second relaxation.