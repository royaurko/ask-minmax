Sunspots are prominent manifestations of the solar cycle and provide key
constraints for understanding its operation. Also, knowing internal structure
of sunspots allows us to gain insights on the energy transport in strong
magnetic fields and, thus, on the processes inside the convection zone, where
solar magnetic fields are generated and amplified before emerging at the
surface on various scales, even during solar minima. In this paper, we present
results of a spectropolarimetric analysis of a sunspot observed during the
declining phase of the solar cycle 23. By inversion of full Stokes spectra
observed in several spectral regions in the optical at the THEMIS facility we
infer the height dependence of physical quantities such as the temperature and
the magnetic field strength for different sunspot regions. The simultaneous use
of atomic (Fe{\sc i} 5250.2 and 5250.6 \AA) and highly temperature sensitive
molecular (TiO 7055 \AA and MgH 5200 \AA) lines allow us to improve a model of
the sunspot umbra.