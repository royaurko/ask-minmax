In this paper we introduce an analytical solution (up to the third order) for
a multistage bunch compression and acceleration system without collective
effects. The solution for the system with collective effects is found by an
iterative procedure based on this analytical result. The developed formalism is
applied to the FLASH facility at DESY. Analytical estimations of RF tolerances
are given.