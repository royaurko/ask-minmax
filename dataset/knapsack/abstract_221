The paper introduces a technique called shape annealing as a solution to an extension of the knapsack problem which is referred to as the constrained geometric knapsack problem that is used for the layout or packing of parts, components, and configurations. Shape annealing , a variation of the simulated annealing stochastic optimization technique, incorporates shape grammars to dictate permissible item orientations in packing problems. Stochastic mutation based on a potential function creates a packing that converges toward the optimum. Results are acceptable but generally not provably optimal, and the algorithm runs in polynomial time and space complexity. The constrained geometric knapsack problem includes geometric constraints and reduces in zero dimensions to the ordiniry knapsack problem. The problem has a wide variety of applications in design and manufacturing.