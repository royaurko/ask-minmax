  Given an n -node tree T = ( V , E ), we are concerned with the problem of selecting a subtree of a given length which optimizes the sum of weighted distances of the nodes from the selected subtree. This problem is NP-hard for both the minimization and the maximization versions since it generalizes the knapsack problem. We present fully polynomial approximation schemes which generate a (1 + ε )-approximation and a (1 − ε )-approximation for the minimization and maximization versions respectively, in time. Keywords Facility location ; Tree-shaped facility ; Knapsack problems [1] E. Balas, E. Zemel An algorithm for large zero-one knapsack problems Oper. Res., 28 (1980), pp. 1130–1154 [2] R. Garey, D.S. Johnson ‘Strong’ NP-completeness results: Motivation, examples, and implications JACM, 25 (1978), pp. 499–508 [3] G.V. Gens Resource allocation in hierarchic systems Eng. Cybernet., 22 (1984), pp. 122–128 [4] G.V. Gens, E.V. Levner Computational complexity of approximation algorithms for combinatorial problems Lecture Notes in Computer Science, vol. 74Springer, Berlin (1979), pp. 292–300 [5] A. Goldman Optimal center location in simple networks Transport. Sci., 5 (1971), pp. 212–221 [6] S.L. Hakimi, E. Schmeichel, M. Labbé On locating path — or tree-shaped facilities on networks Networks, 23 (1993), pp. 543–556 [7] V. Hutson, C. ReVelle Maximal direct covering tree problems Transport. Sci., 23 (1989), pp. 288–299 [8] D.S. Johnson, K.A. Niemi On knapsacks, partitions and a new dynamic programming technique for trees Math. Oper. Res., 8 (1983), pp. 1–14 [9] M. Labbé, E.F. Schmeichel, S.L. Hakimi Approximation algorithms for the capacitated plant location problem Oper. Res. Lett., 15 (1994), pp. 115–126 [10] E. Lawler Fast approximation algorithms for knapsack problems Math. Oper. Res., 4 (1979), pp. 339–356 [11] E. Minieka The optimal location of a path or tree in a tree network Networks, 15 (1985), pp. 309–321 [12] R. Rabinovitch, A. Tamir On a tree-shaped facility location problem of Minieka Networks, 22 (1992), pp. 515–522 [13] S. Sahni General techniques for combinatorial approximations Oper. Res., 25 (1977), pp. 920–936 [14] A. Tamir Obnoxious facility location on graphs SIAM J. Discrete Math., 4 (1991), pp. 550–567 [15] S.S. Ting A linear time algorithm for maximum facility location on tree networks Transport. Sci., 18 (1984), pp. 76–84 Copyright © 1998 Published by Elsevier B.V.