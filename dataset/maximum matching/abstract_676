We compute three-loop matching corrections to the Wilson coefficients $C_7$
and $C_8$ in the Two Higgs Doublet Model by applying expansions for small,
intermediate and large charged Higgs boson masses. The results are used to
evaluate the branching ratio of $\bar{B}\to X_s \gamma$ to next-to-next-to
leading order accuracy, and to determine an updated lower limit on the charged
Higgs boson mass. We find $\mhplus \ge 380 $GeV at 95% confidence level when
the recently completed BABAR data analysis is taken into account. Our results
for the charged Higgs contribution to the branching ratio exhibit considerably
weaker sensitivity to the matching scale $\mu_0$, as compared to previous
calculations.