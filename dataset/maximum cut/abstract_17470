This report presents an Expectation-Maximization (EM) algorithm for
estimation of the maximum-likelihood parameter values of constrained
multivariate autoregressive Gaussian state-space (MARSS) models. The MARSS
model can be written: x(t)=Bx(t-1)+u+w(t), y(t)=Zx(t)+a+v(t), where w(t) and
v(t) are multivariate normal error-terms with variance-covariance matrices Q
and R respectively. MARSS models are a class of dynamic linear model and vector
autoregressive state-space model. Shumway and Stoffer presented an
unconstrained EM algorithm for this class of models in 1982, and a number of
researchers have presented EM algorithms for specific types of constrained
MARSS models since then. In this report, I present a general EM algorithm for
constrained MARSS models, where the constraints are on the elements within the
parameter matrices (B,u,Q,Z,a,R). The constraints take the form vec(M)=f+Dm,
where M is the parameter matrix, f is a column vector of fixed values, D is a
matrix of multipliers, and m is the column vector of estimated values. This
allows a wide variety of constrained parameter matrix forms. The presentation
is for a time-varying MARSS model, where time-variation enters through the
fixed (meaning not estimated) f(t) and D(t) matrices for each parameter. The
algorithm allows missing values in y and partially deterministic systems where
0s appear on the diagonals of Q or R. Open source code for estimating MARSS
models with this algorithm is provided in the MARSS R package on the
Comprehensive R Archive Network (CRAN).