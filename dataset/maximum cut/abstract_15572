This paper presents a new Bayesian model and algorithm used for depth and
intensity profiling using full waveforms from the time-correlated single photon
counting (TCSPC) measurement in the limit of very low photon counts. The model
proposed represents each Lidar waveform as a combination of a known impulse
response, weighted by the target intensity, and an unknown constant background,
corrupted by Poisson noise. Prior knowledge about the problem is embedded in a
hierarchical model that describes the dependence structure between the model
parameters and their constraints. In particular, a gamma Markov random field
(MRF) is used to model the joint distribution of the target intensity, and a
second MRF is used to model the distribution of the target depth, which are
both expected to exhibit significant spatial correlations. An adaptive Markov
chain Monte Carlo algorithm is then proposed to compute the Bayesian estimates
of interest and perform Bayesian inference. This algorithm is equipped with a
stochastic optimization adaptation mechanism that automatically adjusts the
parameters of the MRFs by maximum marginal likelihood estimation. Finally, the
benefits of the proposed methodology are demonstrated through a serie of
experiments using real data.