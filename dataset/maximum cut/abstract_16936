Using a reconstruction of sunspot numbers stretching over multiple millennia,
we analyze the statistics of the occurrence of grand minima and maxima and set
new observational constraints on long-term solar and stellar dynamo models.
  We present an updated reconstruction of sunspot number over multiple
millennia, from $^{14}$C data by means of a physics-based model, using an
updated model of the evolution of the solar open magnetic flux. A list of grand
minima and maxima of solar activity is presented for the Holocene (since 9500
BC) and the statistics of both the length of individual events as well as the
waiting time between them are analyzed.
  The occurrence of grand minima/maxima is driven not by long-term cyclic
variability, but by a stochastic/chaotic process. The waiting time distribution
of the occurrence of grand minima/maxima deviates from an exponential
distribution, implying that these events tend to cluster together with long
event-free periods between the clusters. Two different types of grand minima
are observed: short (30--90 years) minima of Maunder type and long ($>$110
years) minima of Sp\"orer type, implying that a deterministic behaviour of the
dynamo during a grand minimum defines its length. The duration of grand maxima
follows an exponential distribution, suggesting that the duration of a grand
maximum is determined by a random process.
  These results set new observational constraints upon the long-term behaviour
of the solar dynamo.