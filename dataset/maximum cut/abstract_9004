Polynomial-time algorithms are given to find a central decomposition of
maximum size for a finite p-group of class 2 and for a nilpotent Lie ring of
class 2. The algorithms use Las Vegas probabilistic routines to compute the
structure of finite *-rings and also the Las Vegas C-MeatAxe. When p is small,
the probabilistic methods can be replaced by deterministic polynomial-time
algorithms.
  The methods introduce new group isomorphism invariants including new
characteristic subgroups.