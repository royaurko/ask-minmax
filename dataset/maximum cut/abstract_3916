Quasi-thermal Comptonization is an attractive alternative to the synchrotron
process to explain the spectra of GRBs, even if we maintain other important
properties of the internal shock scenario, implying a compact emitting region
and an equipartition magnetic field. Photon-photon absorption and
electron-positron pairs can play a crucial role: this process may lock the
effective temperature in a narrow range and may be the reason why burst spectra
have high energy cut-offs close to the rest mass-energy of the electron. If the
progenitors of GRB are hypernovae, the circum-burst matter is dominated by the
wind of the pre-hypernova star. The presence of this dense material has strong
effects on the generation of the radiation of the burst and its afterglow.