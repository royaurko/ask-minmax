DNA samples are often pooled, either by experimental design, or because the
sample itself is a mixture. For example, when population allele frequencies are
of primary interest, individual samples may be pooled together to lower the
cost of sequencing. Alternatively, the sample itself may be a mixture of
multiple species or strains (e.g. bacterial species comprising a microbiome, or
pathogen strains in a blood sample). We present an expectation-maximization
(EM) algorithm for estimating haplotype frequencies in a pooled sample directly
from mapped sequence reads, in the case where the possible haplotypes are
known. This method is relevant to the analysis of pooled sequencing data from
selection experiments, as well as the calculation of proportions of different
strains within a metagenomics sample. Our method outperforms existing methods
based on single- site allele frequencies, as well as simple approaches using
sequence read data. We have implemented the method in a freely available
open-source software tool.