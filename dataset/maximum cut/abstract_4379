A shape-function independent relation is derived between the partial
B->X_u+l+nu decay rate with a cut on P_+=E_X-P_X<Delta and a weighted integral
over the normalized B->X_s+gamma photon-energy spectrum. The leading-power
contribution to the weight function is calculated at next-to-next-to-leading
order in renormalization-group improved perturbation theory, including exact
two-loop matching corrections at the scale mu_i^2 ~ m_b*Lambda_{QCD}. The
overall normalization of the weight function is obtained up to yet unknown
corrections of order [alpha_s(m_b)]^2. Power corrections from phase-space
factors are included exactly, while the remaining subleading contributions are
included at first order in 1/m_b. At this level unavoidable hadronic
uncertainties enter, which are estimated in a conservative way. The combined
theoretical accuracy in the extraction of |V_{ub}| is at the level of 5% if a
value of Delta near the charm threshold can be achieved experimentally.