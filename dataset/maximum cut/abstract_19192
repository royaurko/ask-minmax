Numerical methods for hyperbolic conservation laws are needed that
efficiently mimic the constraints satisfied by exact solutions, including
material conservation and positivity, while also maintaining high-order
accuracy and numerical stability. Discontinuous Galerkin (DG) and WENO schemes
allow efficient high-order accuracy while maintaining conservation. Positivity
limiters developed by Zhang and Shu ensure a minimum time step for which
positivity of cell average quantities is maintained without sacrificing
conservation or formal accuracy; this is achieved by linearly damping the
deviation from the cell average just enough to enforce a cell positivity
condition that requires positivity at boundary nodes and strategically chosen
interior points.
  We assume that the set of positive states is convex; it follows that
positivity is equivalent to scalar positivity of a collection of affine
functionals. Based on this observation, we generalize the method of Zhang and
Shu to a framework that we call outflow positivity limiting: First, enforce
positivity at boundary nodes. If wave speed desingularization is needed, cap
wave speeds at physically justified maxima by using remapped states to
calculate fluxes. Second, apply linear damping again to cap the boundary
average of all positivity functionals at the maximum possible (relative to the
cell average) for a scalar-valued representation positive in each mesh cell.
This be done by enforcing positivity of the retentional, an affine combination
of the cell average and the boundary average, in the same way that Zhang and
Shu would enforce positivity at a single point (and with similar computational
expense). Third, limit the time step so that cell outflow is less than the
initial cell content. This framework guarantees essentially the same
positivity-preserving time step as is guaranteed if positivity is enforced at
every point in the mesh cell.