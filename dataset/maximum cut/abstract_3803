We derive a multi-band formulation of the orbital magnetization in a normal
periodic insulator (i.e., one in which the Chern invariant, or in 2d the Chern
number, vanishes). Following the approach used recently to develop the
single-band formalism [T. Thonhauser, D. Ceresoli, D. Vanderbilt, and R. Resta,
Phys. Rev. Lett. {\bf 95}, 137205 (2005)], we work in the Wannier
representation and find that the magnetization is comprised of two
contributions, an obvious one associated with the internal circulation of
bulk-like Wannier functions in the interior and an unexpected one arising from
net currents carried by Wannier functions near the surface. Unlike the
single-band case, where each of these contributions is separately
gauge-invariant, in the multi-band formulation only the \emph{sum} of both
terms is gauge-invariant. Our final expression for the orbital magnetization
can be rewritten as a bulk property in terms of Bloch functions, making it
simple to implement in modern code packages. The reciprocal-space expression is
evaluated for 2d model systems and the results are verified by comparing to the
magnetization computed for finite samples cut from the bulk. Finally, while our
formal proof is limited to normal insulators, we also present a heuristic
extension to Chern insulators (having nonzero Chern invariant) and to metals.
The validity of this extension is again tested by comparing to the
magnetization of finite samples cut from the bulk for 2d model systems. We find
excellent agreement, thus providing strong empirical evidence in favor of the
validity of the heuristic formula.