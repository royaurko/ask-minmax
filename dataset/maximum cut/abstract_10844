We have developed a new procedure for the generation of a planetary nebula
luminosity function (PNLF), improving on previous work. The procedure is based,
as before, on an exponential central star mass distribution, on H-burning
post-AGB evolutionary tracks, and on the avoidance of nebular models for the
calculation of nebular fluxes. We have added new post-AGB evolutionary tracks
and introduced the following improvements: (1) the imperfect analytical
representation of post-AGB evolutionary tracks has been replaced by an
interpolation routine giving a better approximation; (2) we have modified the
distribution of the intensities of [O III] lambda 5007 relative to Hbeta, so
that it better imitates the observed distribution, which we have taken from
data in the Strasbourg-ESO catalogue of Galactic PNs and other sources; (3) we
have adjusted the absorbing factor mu along the white dwarf cooling tracks, so
as to reproduce the observed PNLF of the Magellanic Clouds and M 31 at fainter
magnitudes. In this way we have produced a PNLF which is more consistent with
observed PN properties. We use this randomly generated PNLF to: (1) show as
convincingly as possible that most PNs in any real population must leak stellar
H-ionizing photons; (2) revise our determinations of the parameter mu(max); (3)
discuss the shape of the PNLF, hinting at the possible existence of a distinct
feature 2 magnitudes fainter than the brightest PNs; (4) attempt estimates of
maximum final masses from fits to the PNLFs of the LMC and M 31. There is
marginal evidence of a higher maximum final mass in the LMC, but this should be
confirmed in other galaxies with recent star formation. A convincing
confirmation will require to increase the sample sizes and to extend the PNLFs
to at least 1.5 mag fainter than the brightest PNs.