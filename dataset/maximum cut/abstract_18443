We present an evolutionary model for starbursts, quasars, and spheroidal
galaxies in which mergers between gas-rich galaxies drive nuclear inflows of
gas, producing intense starbursts and feeding the buried growth of supermassive
black holes (BHs) until feedback expels gas and renders a briefly visible
optical quasar. The quasar lifetime and obscuring column density depend on both
the instantaneous and peak luminosity of the quasar, and we determine this
dependence using a large set of simulations of galaxy mergers varying host
galaxy properties, orbital geometry, and gas physics. We use these fits to
deconvolve observed quasar luminosity functions (LFs) and obtain the evolution
of the formation rate of quasars with a certain peak luminosity, n(L_peak,z).
Quasars spend extended periods of time at luminosities well below peak, and so
n(L_peak) has a maximum corresponding to the 'break' in the observed LF,
falling off at both brighter and fainter luminosities. From n(L_peak) and our
simulation results, we obtain self-consistent fits to hard and soft X-ray and
optical quasar LFs and predict many observables, including: column density
distributions of optical and X-ray samples, the LF of broad-line quasars in
X-ray samples and the broad-line fraction as a function of luminosity, active
BH mass functions, the distribution of Eddington ratios at z~0-2, the z=0 mass
function of relic BHs and total mass density of BHs, and the cosmic X-ray
background. In every case, our predictions agree well with observed estimates,
and unlike previous modeling attempts, we are able to reproduce them without
invoking any ad hoc assumptions about source properties or distributions. We
provide a library of Monte Carlo realizations of our models for comparison with
observations. (Abridged)