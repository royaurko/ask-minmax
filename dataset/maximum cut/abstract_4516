We define relative Gromov-Witten invariants and establish a general gluing
theory of pseudo-holomorphic curves for symplectic cutting and contact surgery.
Then, we use our general gluing theory to study the change of GW-invariants of
Calabi-Yau 3-folds tranform under flops and extremal transitions. We prove a
complete formula for the change of GW-invariants of any genus transform under
flop and a general type I extremal transition. Other extremal transition will
be handled in a subsequent paper.