We apply a semi-analytic galaxy formation model to two high resolution
cosmological N-body simulations to investigate analogues of the Milky Way
system. We select these according to observed properties of the Milky Way
rather than by halo mass as in most previous work. For disk-dominated central
galaxies with stellar mass (5--7) x 10d10Msun, the median host halo mass is 1.4
x 10d12Msun, with 1 sigma dispersion in the range [0.86, 3.1] x 10d12Msun,
consistent with dynamical measurements of the Milky Way halo mass. For any
given halo mass, the probability of hosting a Milky Way system is low, with a
maximum of ~20% in haloes of mass ~10d12Msun. The model reproduces the V-band
luminosity function and radial profile of the bright (MV < -9) Milky Way
satellites. Galaxy formation in low mass haloes is found to be highly
stochastic, resulting in an extremely large scatter in the relation between MV
(or stellar mass) for satellites and the depth of the subhalo potential well in
which they live, as measured by the maximum of the rotation curve, Vmax. We
conclude that the "too big to fail" problem is an artifact of selecting
satellites in N-body simulations according to subhalo properties: in 10% of
cases we find that three or fewer of the brightest (or most massive) satellites
have Vmax > 30 km/s. Our model predicts that around half of the dark matter
subhaloes with Vmax > 20 km/s host satellites fainter than MV = -9 and so may
be missing from existing surveys.