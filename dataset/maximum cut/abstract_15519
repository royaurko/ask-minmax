Stochastic digital backpropagation (SDBP) is an extension of digital
backpropagation (DBP) and is based on the maximum a posteriori principle. SDBP
takes into account noise from the optical amplifiers in addition to handling
deterministic linear and nonlinear impairments. The decisions in SDBP are taken
on a symbol-by-symbol (SBS) basis, ignoring any residual memory, which may be
present due to non-optimal processing in SDBP. In this paper, we extend SDBP to
account for memory between symbols. In particular, two different methods are
proposed: a Viterbi algorithm (VA) and a decision directed approach. Symbol
error rate (SER) for memory-based SDBP is significantly lower than the
previously proposed SBS-SDBP. For inline dispersion-managed links, the VA-SDBP
has up to 10 and 14 times lower SER than DBP for QPSK and 16-QAM, respectively.