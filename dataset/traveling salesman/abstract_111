Password: The probabilistic traveling salesman problem concerns the best way to visit a set of customers located in some metric space, where each customer requires a visit only with some known probability. A solution to this problem is an a priori tour which visits all customers, and the objective is to minimize the expected length of the a priori tour over all customer subsets, assuming that customers in any given subset must be visited in the same order as they appear in the a priori tour. This problem belongs to the class of stochastic vehicle routing problems, a class which has received increasing attention in recent years, and which is of major importance in real world applications. Several heuristics have been proposed and tested for the probabilistic traveling salesman problem, many of which are a straightforward adaptation of heuristics for the classical traveling salesman problem. In particular, two local search algorithms (2-p-opt and 1-shift) were introduced by Bertsimas. In a previous report we have shown that the expressions for the cost evaluation of 2-p-opt and 1-shift moves, as proposed by Bertsimas, are not correct. In this paper we derive the correct versions of these expressions, and we show that the local search algorithms based on these expressions perform significantly better than those exploiting the incorrect expressions. Keywords Combinatorial optimization ; Probabilistic traveling salesman problem ; Heuristics ; Local search 1. Statement of the problem The probabilistic traveling salesman problem (PTSP) is a traveling salesman problem (TSP) where each customer i =1,2,…, n has a given probability p i of requiring a visit. A feasible solution to the PTSP is an a priori tour τ visiting all customers. The a priori tour is interpreted as providing a template for constructing a tour of any particular subset of customers. More precisely, for any given set of customers requiring a visit, they should be visited in the same order that they appear in the a priori tour. This tour construction strategy enables, for example, a supermarket supplier, to rapidly adapt its daily delivery rounds to just those customers that require a supply that day. Thus, given this interpretation of the a priori tour, the objective of the PTSP is to minimize the expected length of the a priori tour over all customer subsets. The PTSP is an NP-hard problem [2]  and  [5] , and was introduced in 1985 in [12] . Heuristic approaches to this problem have been analyzed in [2] , [4]  and  [14] and an exact algorithm has been developed for small instances (up to 50 customers) in [13] . Theoretical properties of the PTSP (bounds, asymptotic analysis) have been derived in [4]  and  [5] . The PTSP has also recently been tackled, [6] , [7] , [9]  and  [10] , especially with new algorithmic approaches based on metaheuristics [11] . In this paper we restrict our attention to the homogeneous PTSP with symmetric distances, that is, a PTSP where each customer has the same probability p of requiring a visit, independently of the others, and where for every couple of customers i , j , the distance of traveling from i to j is equal to the distance of traveling from j to i . Given an a priori tour τ = τ (1), τ (2),…, τ ( n ), its expected length (that is, the objective function), is computed in O( n 2 ) by the following expression [12] : equation ( 1 ) equation ( 2 ) The meaning of Eq. (1) is as follows. In each term of the sum the distance between the i th city τ ( i ) and the ( i + r )th city τ ( i + r ) is weighted by the probability that the two nodes require a visit ( p 2 ) while the r −1 nodes between them do not require a visit ((1− p ) r −1 ). In other words, each arc ( τ ( i ), τ ( i + r )) is weighted by a probability coefficient p 2 (1− p ) r −1 . Using the full evaluation function (Eq. (1) ) to evaluate the cost of moves in a local search is very expensive and so it would be desirable to have a `delta' evaluation function (to calculate the cost difference between two neighboring tours) of a much lower complexity. To this end, Bertsimas [2]  and  [4] has previously proposed delta evaluation expressions for two local search moves, namely 2-p-opt and 1-shift, described below, which compute the cost evaluations of the entire O( n 2 )-sized neighborhood of a tour in O( n 2 ) time. Unfortunately, as we have shown in [8] , they do not correctly calculate the change in expected tour length. It is the purpose of this paper to derive correct versions of them. The remainder of the paper is organized as follows. In Section 2 we describe the 2-p-opt move and we derive the correct recursive delta evaluation expression. Section 3 follows a similar course but with respect to the 1-shift operator. In Section 4 we perform computational experiments showing the effects of using the incorrect expressions in [2]  and  [4] . 2. The 2-p-opt The 2-p-opt local search was introduced by Bertsimas in [2] , later published in an article by Bertsimas and Howell [4] , and applied again by Bertsimas, et al. in [3] . Given an a priori tour τ , its 2-p-opt neighborhood is the set of tours obtained by reversing a section of τ (that is, a set of consecutive nodes) and adjusting the arcs adjacent to the reversed section, as for example in Fig. 1 . Fig. 1. 