Password: The probabilistic traveling salesman problem is a well known problem that is quite challenging to solve. It involves finding the tour with the lowest expected cost for customers that will require a visit with a given probability. There are several proposed algorithms for the homogeneous version of the problem, where all customers have identical probability of being realized. From the literature, the most successful approaches involve local search procedures, with the most famous being the 2-p-opt and 1-shift procedures proposed by Bertsimas [D.J. Bertsimas, L. Howell, Further results on the probabilistic traveling salesman problem, European Journal of Operational Research 65 (1) (1993) 68–95]. Recently, however, evidence has emerged that indicates the equations offered for these procedures are not correct, and even when corrected, the translation to the heterogeneous version of the problem is not simple. In this paper we extend the analysis and correction to the heterogeneous case. We derive new expressions for computing the cost of 2-p-opt and 1-shift local search moves, and we show that the neighborhood of a solution may be explored in O( n 2 ) time, the same as for the homogeneous case, instead of O( n 3 ) as first reported in the literature. Keywords Combinatorial optimization ; Probabilistic traveling salesman ; Heuristics ; Local search ; Stochastic vehicle routing 1. Introduction For many delivery companies, only a subset of their customers require a pickup or delivery each day. Information may be not available far enough in advance to create optimal schedules each day for those customers that do require a visit or the cost to acquire sufficient computational power to find such solutions may be prohibitive. For these reasons, it is not unusual to design a distance minimizing tour containing all customers, and each day follow the ordering of this a priori tour to visit only the customers requiring a visit that day. The problem of finding an a priori tour of minimum expected cost, for a set of customers each with a given probability of requiring a visit, defines the Probabilistic Traveling Salesman Problem (PTSP). Jaillet [9] was the first to look at how to evaluate the expected cost of an a priori tour. In [9]  and  [10] , Jaillet points out that the optimal TSP tour through a set of customers is often not the optimal tour in an expected value sense which means that the PTSP should be solved separately from the TSP. Due to the probabilistic nature of the problem, the cost of evaluating a proposed solution for the PTSP is expensive. This, combined with the fact that TSP problems are already hard to solve, makes it quite challenging to solve PTSP problems to optimality. An exact algorithm is described in [11] , but it has been applied primarily to small instances of the problem. Most approaches in the PTSP literature focus on heuristics that efficiently find good, but not necessarily optimal, solutions (see for instance [3] , [4] , [6]  and  [8] and the references cited therein). One crucial ingredient in these heuristic approaches is the design of an effective local search algorithm. For the PTSP, the use of an expected value-based cost to evaluate a local search move, rather than a standard TSP local search procedure, grows increasingly important as the number of customers increases [3] . Thus, it is critical that the expected value-based costs in the local search procedures are quick to evaluate. In the literature, there are two local search procedures created specifically for the PTSP that evaluate a change in terms of expected value: the 2-p-opt and the 1-shift. The 2-p-opt is the probabilistic version of the famous 2-opt procedure created for the TSP [12] . In 2-opt, the portion of the tour between two specified customers is reversed. The 2-p-opt and the 2-opt are identical in terms of local search neighborhoods, but greatly differ in the cost computation. The change in the TSP objective value (the tour length) can be easily computed in constant time, while the same cannot be said for the PTSP objective value. The 1-shift is the evaluation of the change in expected value associated with removing a customer from the tour and inserting it at another point in the tour. For PTSP instances where each customer is present with the same probability (the homogeneous PTSP), Bertsimas proposed move evaluation expressions in [3] that explore the neighborhood of a solution (that is, that verify whether an improving 2-p-opt or 1-shift move exists) in O( n 2 ) time. The intent of Bertsimas’ equations is to provide a recursive means to quickly compute the exact change in expected value associated with either a 2-p-opt or 1-shift procedure. Evaluating the cost of a local move by computing the cost of two neighboring solutions and then evaluating their difference would require much more time (O( n 4 )) than a recursive approach. Recently Bianchi et al. [5] re-analyzed and corrected Bertsimas’ expressions, after evidence emerged that they did not exactly evaluate the cost of a 2-p-opt and 1-shift move. The correction of these equations confirms that it is possible to explore both the 2-p-opt and 1-shift neighborhood of a solution in O( n 2 ) time, and does, as expected, create significant improvement in the already good results for the homogeneous PTSP. The heterogeneous version, where probabilities at the various customers are allowed to vary, is actually a more important problem because it is clearly closer to real world applications. As delivery companies gather and retain more information about their customers, heterogeneous probabilities are becoming increasingly available in practice and represent large potential savings. Few of the results in the literature apply, though, when probabilities are not homogeneous. One paper, [1] , provides a lower bound for the heterogeneous PTSP, and another paper, [2] , reports computational results of 2-p-opt and 1-shift local search algorithms applied to some small heterogeneous PTSP instances. The results in [2] are based on the work of Chervi [7] , who proposed recursive expressions for the cost of 2-p-opt and 1-shift moves for the heterogeneous PTSP. Chervi’s expressions explore the 2-p-opt and 1-shift neighborhoods in O( n 3 ) time, suggesting that it is not possible to retain the O( n 2 ) complexity of the homogeneous PTSP. Moreover, Chervi’s expressions reduce to the incorrect expressions for the homogeneous PTSP published in [3] , when all customer probabilities are equal, and therefore are also not correct. In this paper, we extend and generalize the analysis performed in [5] for the homogeneous case to the heterogeneous case and derive new expressions for computing the cost of 2-p-opt (Section 3 ) and 1-shift (Section 4 ) local search moves. We demonstrate that the neighborhood of a solution for this important problem may be explored in O( n 2 ) time, thus retaining the same complexity as the homogeneous case. This shows we can take advantage of important additional information without adding computational complexity.