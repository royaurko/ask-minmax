A unicellular map is the embedding of a connected graph in a surface in such
a way that the complement of the graph is simply connected. In a famous
article, Harer and Zagier established a formula for the generating function of
unicellular maps counted according to the number of vertices and edges. The
keystone of their approach is a counting formula for unicellular maps on
orientable surfaces with $n$ edges, and with vertices colored using every color
in $[q]$ (adjacent vertices are contributorized to have the same color). We give an
analogue of this formula for general (locally orientable) surfaces. Our
approach is bijective and is inspired by Lass's proof of the Harer-Zagier
formula. We first revisit Lass's proof and twist it into a bijection between
unicellular maps on orientable surfaces with vertices colored using every color
in $[q]$, and maps with vertex set $[q]$ on orientable surfaces \emph{with a
marked spanning tree}. The bijection immediately implies Harer-Zagier's formula
and a formula by Jackson concerning bipartite unicellular maps. It also shed a
new light on constructions by Goulden and Nica, Schaeffer and Vassilieva, and
Morales and Vassilieva. We then extend the bijection to general surfaces and
obtain a correspondence between unicellular maps on general surfaces with
vertices colored using every color in $[q]$, and maps on orientable surfaces
with vertex set $[q]$ \emph{with a marked planar submap}. This correspondence
gives an analogue of the Harer-Zagier formula for general surfaces. We also
show that this formula implies a recursion formula due to Ledoux for the
numbers of unicellular maps with given numbers of vertices and edges.