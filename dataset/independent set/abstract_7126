Here we present a novel N-body simulation technique that allows us to compute
ensemble statistics on a local basis, directly relating halo properties to
their environment. This is achieved by the use of an ensemble simulation in
which the otherwise independent realizations share the same fluctuations above
a given cut-off scale. This produces a constrained ensemble where the LSS is
common to all realizations while having an independent halo population. By
generating a large number of semi-independent realizations we can effectively
increase the local halo density by an arbitrary factor thus breaking the
fundamental limit of the finite halo density (for a given halo mass range)
determined by the halo mass function.
  This technique allows us to compute local ensemble statistics of the
matter/halo distribution at a particular position in space, removing the
intrinsic stochasticity in the halo formation process and directly relating
halo properties to their environment. This is a major improvement over global
descriptors of the matter/halo distribution which can not resolve local
variations.
  We introduce the Multum In Parvo (MIP) constrained ensemble simulation
consisting of 220 realizations of a 32 h^{-1} Mpc box with 256^3 particles
each. We illustrate the potential of the technique presented here by computing
the local mass function at several characteristic environments and along a path
from the center of a void to its border. We can study for the first time the
effect of local environment in the height, shape and characteristic mass of the
halo mass function.