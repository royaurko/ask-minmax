In this paper we generalize the flux ratio method Bailey et al. (2009) to the
case of two luminosity indicators and search the optimal luminosity-flux ratio
relations on a set of spectra whose phases are around not only the date of
bright light but also other time. With these relations, a new method is
proposed to constrain the host galaxy extinction of SN Ia and its distance. It
is first applied to the low redshift supernovas and then to the high redshift
ones. The results of the low redshift supernovas indicate that the flux ratio
method can indeed give well constraint on the host galaxy extinction parameter
E(B-V), but weaker constraints on R_{V}. The high redshift supernova spectra
are processed by the same method as the low redshift ones besides some
differences due to their high redshift. Among 16 high redshift supernovas, 15
are fitted very well except 03D1gt. Based on these distances, Hubble diagram is
drew and the contents of the Universe are analyzed. It supports an acceleration
behavior in the late Universe. Therefore, the flux ratio method can give
constraints on the host galaxy extinction and supernova distance independently.
We believe, through further studies, it may provide a precise tool to probe the
acceleration of the Universe than before.