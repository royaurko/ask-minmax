In [GW09a] we conjectured that uniformity of degree $k-1$ is sufficient to
control an average over a family of linear forms if and only if the $k$th
powers of these linear forms are linearly independent. In this paper we prove
this conjecture in $\mathbb{F}_p^n$, provided only that $p$ is sufficiently
large. This result represents one of the first applications of the recent
inverse theorem for the $U^k$ norm over $\mathbb{F}_p^n$ by Bergelson, Tao and
Ziegler [BTZ09,TZ08]. We combine this result with some abstract arguments in
order to prove that a bounded function can be expressed as a sum of polynomial
phases and a part that is small in the appropriate uniformity norm. The precise
form of this decomposition theorem is critical to our proof, and the theorem
itself may be of independent interest.