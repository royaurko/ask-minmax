(abridged) We present a new time-dependent multi-zone radiative transfer code
and its application to study the SSC emission of Mrk 421. The code couples
Fokker-Planck and Monte Carlo methods, in a 2D geometry. For the first time all
the light travel time effects (LCTE) are fully considered, along with a proper
treatment of Compton cooling, which depends on them. We study a set of simple
scenarios where the variability is produced by injection of relativistic
electrons as a `shock front' crosses the emission region. We consider emission
from two components, with the second one either being pre-existing and
co-spatial and participating in the evolution of the active region, or
spatially separated and independent, only diluting the observed variability.
Temporal and spectral results of the simulation are compared to the
multiwavelength observations of Mrk 421 in March 2001. We find parameters that
can adequately fit the observed SEDs and multiwavelength light curves and
correlations. There remain however a few open issues, most notably: i)
systematic soft intra-band X-ray lags. ii) The quadratic correlation between
the TeV and X-ray flux during the flare decay has not been reproduced. These
features are among those affected by the spatial extent and geometry of the
source. The difficulty of producing hard X-ray lags is exacerbated by a bias
towards soft lags caused by the combination of energy dependent radiative
cooling time-scales and LCTE. About the second emission component, our results
strongly favor the scenario where it is co-spatial and it participates in the
flare evolution, suggesting that different phases of activity may occur in the
same region. The cases presented in this paper represent only an initial study,
and despite their limited scope they make a strong case for the need of true
time-dependent and multi-zone modeling.