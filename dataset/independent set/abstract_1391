We present a methodology for computing model independent perturbations in
dark energy and modified gravity. This is done from the Lagrangian for
perturbations, by showing how field content, symmetries, and physical
principles are often sufficient ingredients for closing the set of perturbed
fluid equations. The fluid equations close once "equations of state for
perturbations" are identified: these are linear combinations of fluid and
metric perturbations which construct gauge invariant entropy and anisotropic
stress perturbations for broad classes of theories. Our main results are the
proof of the equation of state for perturbations presented in a previous paper,
and the development of the required calculational tools.