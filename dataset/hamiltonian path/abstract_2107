In this paper we give the full microscopic derivation of the model
Hamiltonian for the three dimensional topological insulators in the $Bi_2Se_3$
family of materials ($Bi_2Se_3$, $Bi_2Te_3$ and $Sb_2Te_3$). We first give a
physical picture to understand the electronic structure by analyzing atomic
orbitals and applying symmetry principles. Subsequently, we give the full
microscopic derivation of the model Hamiltonian introduced by Zhang {\it et al}
[\onlinecite{zhang2009}] based both on symmetry principles and the ${\bf
k}\cdot{\bf p}$ perturbation theory. Two different types of $k^3$ terms, which
break the in-plane full rotation symmetry down to three fold rotation symmetry,
are taken into account. Effective Hamiltonian is derived for the topological
surface states. Both the bulk and the surface models are investigated in the
presence of an external magnetic field, and the associated Landau level
structure is presented. For more quantitative fitting to the first principle
calculations, we also present a new model Hamiltonian including eight energy
bands.