It is shown that the Regge-Teitelboim criterion for fixing the unique
boundary contribution to the Hamiltonian compatible with free boundary
conditions should be modified if the Poisson structure is noncanonical. The new
criterion requires cancellation of boundary contributions to the Hamiltonian
equations of motion. In the same time, boundary contributions to the variation
of Hamiltonian are allowed. The Ashtekar formalism for gravity and
hydrodynamics of the ideal fluid with a free surface in the Clebsch variables
are treated as examples.