Four-dimensional Cone Beam Computed Tomography (4D-CBCT) has been developed
to provide respiratory phase resolved volumetric imaging in image guided
radiation therapy (IGRT). Inadequate number of projections in each phase bin
results in low quality 4D-CBCT images with obvious streaking artifacts. In this
work, we propose two novel 4D-CBCT algorithms: an iterative reconstruction
algorithm and an enhancement algorithm, utilizing a temporal nonlocal means
(TNLM) method. We define a TNLM energy term for a given set of 4D-CBCT images.
Minimization of this term favors those 4D-CBCT images such that any anatomical
features at one spatial point at one phase can be found in a nearby spatial
point at neighboring phases. 4D-CBCT reconstruction is achieved by minimizing a
total energy containing a data fidelity term and the TNLM energy term. As for
the image enhancement, 4D-CBCT images generated by the FDK algorithm are
enhanced by minimizing the TNLM function while keeping the enhanced images
close to the FDK results. A forward-backward splitting algorithm and a
Gauss-Jacobi iteration method are employed to solve the problems. The
algorithms are implemented on GPU to achieve a high computational efficiency.
The reconstruction algorithm and the enhancement algorithm generate visually
similar 4D-CBCT images, both better than the FDK results. Quantitative
evaluations indicate that, compared with the FDK results, our reconstruction
method improves contrast-to-noise-ratio (CNR) by a factor of 2.56~3.13 and our
enhancement method increases the CNR by 2.75~3.33 times. The enhancement method
also removes over 80% of the streak artifacts from the FDK results. The total
computation time is ~460 sec for the reconstruction algorithm and ~610 sec for
the enhancement algorithm on an NVIDIA Tesla C1060 GPU card.