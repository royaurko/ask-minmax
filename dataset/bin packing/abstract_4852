Fix a finite ordinal n>2. We show that there exists an atomic, simple and
countable representable CA_n, such that its minimal completion is outside
SNr_nCA_{n+3}. Hence, for any finite k\geq 3, the variety SNr_nCA_{n+k} is not
atom-canonical, so that the variety of CA_n's having n+k-flat representations
is not atom-canonical, too. We show, for finite k\geq 3, that S_cNr_nCA_{n+k}
is not elementary, hence the class of CA_n's having complete n+3-smooth
representations is not elementary. We obtain analogous results by replacing
flat and smooth, respectively, by (the weaker notion of) square; this give a
stronger result in both cases and here we can allow k to be infinite. Our
results are proved using rainbow constructions for CA's. We lift the negative
result on atom-canonicity to the transfinite. We also show that for any ordinal
\alpha\geq \omega, for any finite k\geq 1, and for any r\in \omega, there
exists an atomic algebra A_r\in SNr_\alphaCA_{\alpha+k}\sim
SNr_nCA_{\alpha+k+1}, such that \Pi_{r/U} A_r\in RCA_{\alpha} where U is any
non--principal ultrafilter on \omega. Reaping the harvest of our algebraic
results we investigate a plethora of omitting types theorems for variants of
first logic including its finite variable fragments and its packed fragment.