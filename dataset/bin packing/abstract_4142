We develop a novel method to separate the components of a diffuse emission
process based on an association with the energy spectra. Most of the existing
methods use some information about the spatial distribution of components,
e.g., closeness to an external template, independence of components etc., in
order to separate them. In this paper we propose a method where one puts
conditions on the spectra only. The advantages of our method are: 1) it is
internal: the maps of the components are constructed as combinations of data in
different energy bins, 2) the components may be correlated among each other, 3)
the method is semi-blind: in many cases, it is sufficient to assume a
functional form of the spectra and determine the parameters from a maximization
of a likelihood function. As an example, we derive the CMB map and the
foreground maps for seven yeas of WMAP data. In an Appendix, we present a
generalization of the method, where one can also add a number of external
templates.