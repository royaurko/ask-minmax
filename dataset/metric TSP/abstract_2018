Let $\1$ and $\2$ be $\s$ domains in $\Cn$ and $f: \1 \rt \2$ an isometry for
the Kobayashi or Carath\'eodory metrics. Suppose that $f$ extends as a $C^1$
map to $ \bar \om_1$. We then prove that $f|_{\partial \1}: \partial \1 \rt
\partial \2$ is a CR or anti-CR diffeomorphism. It follows that $\1$ and $\2$
must be biholomorphic or anti-biholomorphic.
  The main tool is a metric version of the Pinchuk rescaling technique.