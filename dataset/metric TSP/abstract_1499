For two metric spaces X and Y, say that X {threshold-embeds} into Y if there
exist a number K > 0 and a family of Lipschitz maps $f_{\tau} : X \to Y : \tau
> 0 \}$ such that for every $x,y \in X$, \[ d_X(x,y) \geq \tau =>
d_Y(f_{\tau}(x),f_{\tau}(y)) \geq \|\varphi_{\tau}\|_{\Lip} \tau/K \] where
$\|f_{\tau}\|_{\Lip}$ denotes the Lipschitz constant of $f_{\tau}$. We show
that if a metric space X threshold-embeds into a Hilbert space, then X has
Markov type 2. As a consequence, planar graph metrics and doubling metrics have
Markov type 2, answering questions of Naor, Peres, Schramm, and Sheffield. More
generally, if a metric space X threshold-embeds into a p-uniformly smooth
Banach space, then X has Markov type p. This suggests some non-linear analogs
of Kwapien's theorem. For instance, a subset $X \subseteq L_1$ threshold-embeds
into Hilbert space if and only if X has Markov type 2.