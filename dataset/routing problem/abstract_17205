This paper describes a massively parallel algebraic multigrid method based on
non-smoothed aggregation. It is especially suited for solving heterogeneous
elliptic problems as it uses a greedy heuristic algorithm for the aggregation
that detects changes in the coefficients and prevents aggregation across them.
Using decoupled aggregation on each process with data agglomeration onto fewer
processes on the coarse level, it weakly scales well in terms of both total
time to solution and time per iteration to nearly 300,000 cores. Because of
simple piecewise constant interpolation between the levels, its memory
consumption is low and allows solving problems with more than 100,000,000,000
degrees of freedom.