We present false discovery rate smoothing, an empirical-Bayes method for
exploiting spatial structure in large multiple-testing problems. FDR smoothing
automatically finds spatially localized regions of significant test statistics.
It then relaxes the threshold of statistical significance within these regions,
and tightens it elsewhere, in a manner that controls the overall
false-discovery rate at a given level. This results in increased power and
cleaner spatial separation of signals from noise. The approach requires solving
a non-standard high-dimensional optimization problem, for which an efficient
augmented-Lagrangian algorithm is presented. We demonstrate that FDR smoothing
exhibits state-of-the-art performance on simulated examples. We also apply the
method to a data set from an fMRI experiment on spatial working memory, where
it detects patterns that are much more biologically plausible than those
detected by existing FDR-controlling methods. All code for FDR smoothing is
publicly available in Python and R.