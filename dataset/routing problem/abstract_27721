The semi-geostrophic system is widely used in the modelling of large-scale
atmospheric flows. In this paper, we prove existence of solutions of the
incompressible semi-geostrophic equations in a fully three-dimensional domain
with a free upper boundary condition.
  We show that, using methods similar to those introduced in the pioneering
work of Benamou and Brenier, who analysed the same system but with a rigid
boundary condition, we can prove the existence of solutions for the
incompressible free boundary problem. The proof is based on optimal transport
results as well as the analysis of Hamiltonian ODEs in spaces of probability
measures given by Ambrosio and Gangbo. We also show how these techniques can be
modified to yield the same result also for the compressible version of the
system.