Most decision theories, including expected utility theory, rank dependent
utility theory and cumulative prospect theory, assume that investors are only
interested in the distribution of returns and not in the states of the economy
in which income is received. Optimal payoffs have their lowest outcomes when
the economy is in a downturn, and this feature is often at odds with the needs
of many investors. We introduce a framework for portfolio selection within
which state-dependent preferences can be accommodated. Specifically, we assume
that investors care about the distribution of final wealth and its interaction
with some benchmark. In this context, we are able to characterize optimal
payoffs in explicit form. Furthermore, we extend the classical expected utility
optimization problem of Merton to the state-dependent situation. Some
applications in security design are discussed in detail and we also solve some
stochastic extensions of the target probability optimization problem.