We solve the problem of constructing all chiral genus-one correlation
functions from chiral genus-zero correlation functions associated to a vertex
operator algebra satisfying the following conditions: (i) the weight of any
nonzero homogeneous elements of V is nonnegative and the weight zero subspace
is one-dimensional, (ii) every N-gradable weak V-module is completely reducible
and (iii) V is C_2-cofinite. We establish the fundamental properties of these
functions, including suitably formulated commutativity, associativity and
modular invariance. The method we develop and use here is completely different
from the one previously used by Zhu and other people. In particular, we show
that the $q$-traces of products of certain geometrically-modified intertwining
operators satisfy modular invariant systems of differential equations which,
for any fixed modular parameter, reduce to doubly-periodic systems with only
regular singular points. Together with the results obtained by the contributor in
the genus-zero case, the results of the present paper solves essentially the
problem of constructing chiral genus-one weakly conformal field theories from
the representations of a vertex operator algebra satisfying the conditions
above.