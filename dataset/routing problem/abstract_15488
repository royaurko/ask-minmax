In the propositional modal (and algebraic) treatment of two-variable
first-order logic equality is modelled by a `diagonal' constant, interpreted in
square products of universal frames as the identity (also known as the
`diagonal') relation. Here we study the decision problem of products of two
arbitrary modal logics equipped with such a diagonal. As the presence or
absence of equality in two-variable first-order logic does not influence the
complexity of its satisfiability problem, one might expect that adding a
diagonal to product logics in general is similarly harmless. We show that this
is far from being the case, and there can be quite a big jump in complexity,
even from decidable to the highly undecidable. Our undecidable logics can also
be viewed as new fragments of first- order logic where adding equality changes
a decidable fragment to undecidable. We prove our results by a novel
application of counter machine problems. While our formalism apparently cannot
force reliable counter machine computations directly, the presence of a unique
diagonal in the models makes it possible to encode both lossy and
insertion-error computations, for the same sequence of instructions. We show
that, given such a pair of faulty computations, it is then possible to
reconstruct a reliable run from them.