This paper formulates the authentication planning problem when network coding
is implemented in a wireless sensor network. The planning problem aims at
minimizing the energy consumed by the security application which is guarantied
using message authentication codes. This paper proposes a binary non-linear
optimization formulation for this planning problem whose decision variables are
the authentication decision of the nodes and the MAC modes of operation. It is
illustrated for a butterfly topology. Results show that there is a real
trade-off between energy efficiency and message throughput in this context.