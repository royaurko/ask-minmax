This paper reports security problems with improper implementations of an
improved version of FEA-M (fast encryption algorithm for multimedia). It is
found that an implementation-dependent differential chosen-plaintext attack or
its chosen-ciphertext counterpart can reveal the secret key of the
cryptosystem, if the involved (pseudo-)random process can be tampered (for
example, through a public time service). The implementation-dependent
differential attack is very efficient in complexity and needs only $O(n^2)$
chosen plaintext or ciphertext bits. In addition, this paper also points out a
minor security problem with the selection of the session key. In real
implementations of the cryptosystem, these security problems should be
carefully avoided, or the cryptosystem has to be further enhanced to work under
such weak implementations.