This is an analytic study of the problem of transitions between normal and
superconducting phases for a sample which encloses a magnetic flux. A
preliminary study of this problem, based on numerical minimization of the free
energy for a particular form of the thickness of the sample, was published in
Phys. Rev. Lett. {\bf 75}, 320 (1995). For a sample of uniform thickness the
order parameter is uniform, but even infinitesimal deviations from uniform
thickness give rise to a singly connected state in which the order parameter
vanishes at a suitable layer, so that the superconducting part does not enclose
the magnetic field. The stability domain of this singly connected state is a
line segment in the magnetic field-temperature plane, delimited by two critical
points. The phase diagram contains several bifurcation lines, which are
systematically analyzed.