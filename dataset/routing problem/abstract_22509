We show that the discrepancy between the Tully-Fisher relation and the
luminosity function predicted by most phenomenological galaxy formation models
is mainly due to overmerging of galaxy haloes. We have circumvented this
overmerging problem, which is inherent in both the Press-Schechter formalism
and dissipationless N-body simulations, by including a specific galaxy halo
formation recipe into an otherwise standard N-body code. This numerical
technique provides the merger trees which, together with simplified gas
dynamics and star formation physics, constitute our implementation of a
phenomenological galaxy formation model. Resolving the overmerging problem
provides us with the means to match both the I-band Tully-Fisher relation and
the B and K band luminosity functions within an EdS sCDM structure formation
scenario. It also allows us to include models for chemical evolution and
starbursts, which improves the match to observational data and renders the
modelling more realistic. We show that the inclusion of chemical evolution into
the modelling requires a significant fraction of stars to be formed in short
bursts triggered by merging events.