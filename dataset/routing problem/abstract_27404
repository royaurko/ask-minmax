We consider the problem of estimating the means $\mu_i$ of $n$ random
variables $Y_i \sim N(\mu_i,1)$, $i=1,\ldots ,n$. Assuming some structure on
the $\mu$ process, e.g., a state space model, one may use a summary statistics
for the contribution of the rest of the observations to the estimation of
$\mu_i$. The most important example for this is the Kalman filter. We introduce
a non-linear improvement of the standard weighted average of the given summary
statistics and $Y_i$ itself, using empirical Bayes methods. The improvement is
obtained under mild assumptions. It is strict when the process that governs the
states $\mu_1,\ldots,\mu_n $ is not a linear Gaussian state-space model. We
consider both the sequential and the retrospective estimation problems.