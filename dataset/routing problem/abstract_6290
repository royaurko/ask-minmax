We study the dual formulation of the utility maximization problem in
incomplete markets when the utility function is finitely valued on the whole
real line. We extend the existing results in this literature in two directions.
  First, we allow for nonsmooth utility functions, so as to include the
shortfall minimization problems in our framework. Second, we allow for the
presence of some given liability or a random endowment. In particular, these
results provide a dual formulation of the utility indifference valuation rule.