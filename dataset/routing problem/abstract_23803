We construct a diagram D, indexed by a finite partially ordered set, of
finite Boolean semilattices and (v,0,1)-embeddings, with top semilattice $2^4$,
such that for any variety V of algebras, if D has a lifting, with respect to
the congruence lattice functor, by algebras and homomorphisms in V, then there
exists an algebra $U$ in V such that the congruence lattice of $U$ contains, as
a 0,1-sublattice, the five-element modular nondistributive lattice $M_3$. In
particular, V has an algebra whose congruence lattice is neither join- nor
meet-semidistributive. Using earlier work of K.A. Kearnes and A.Szendrei, we
also deduce that V has no nontrivial congruence lattice identity. In
particular, there is no functor F from finite Boolean semilattices and
(v,0,1)-embeddings to lattices and lattice embeddings such that the composition
Con F is equivalent to the identity (where Con denotes the congruence lattice
functor), thus solving negatively a problem raised by P. Pudlak in 1985 about
the existence of a functorial solution of the Congruence Lattice Problem.