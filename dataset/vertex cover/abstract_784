We classify the irreducible restricted modules for the affine Nappi-Witten
Lie algebra $\hat{H}_{4}$ with some natural conditions. It turns out the
representation theory of $\hat{H}_{4}$ is quite different from the theory of
representations of Heisenberg algebras. We also study the extension of the
vertex operator algebra $V_{\hat{H}_{4}}(\ell,0)$ by the even lattice $L$. We
give the structure of the extension $V_{\hat{H}_{4}}(\ell,0)\otimes \C[L]$ and
its irreducible modules via irreducible representations of
$V_{\hat{H}_{4}}(\ell,0)$ viewed as a vertex algebra.