For every natural number k we prove a decomposition theorem for bounded
measurable functions on compact abelian groups into a structured part, a quasi
random part and a small error term. In this theorem quasi randomness is
measured with the Gowers norm U(k+1) and the structured part is a bounded
complexity ``nilspace-polynomial'' of degree k. This statement implies a
general inverse theorem for the U(k+1) norm. (We discuss some consequences in
special families of groups such as bounded exponent groups, zero characteristic
groups and the circle group.) Along these lines we introduce a convergence
notion and corresponding limit objects for functions on abelian groups. This
subject is closely related to the recently developed graph and hypergraph limit
theory. An important goal of this paper is to put forward a new algebraic
aspect of the notion ``higher order Fourier analysis''. According to this, k-th
order Fourier analysis is regarded as the study of continuous morphisms between
structures called compact k-step nilspaces. All our proofs are based on an
underlying theory of topological nilspace factors of ultra product groups.