The concept of vehicle-to-grid (V2G) has gained recent interest as more and
more electric vehicles (EVs) are put to use. In this paper, we consider a
dynamic aggregator-EVs system, where an aggregator centrally coordinates a
large number of dynamic EVs to perform regulation service. We propose a
Welfare-Maximizing Regulation Allocation (WMRA) algorithm for the aggregator to
fairly allocate the regulation amount among its EVs. Compared to previous
works, WMRA accommodates a wide spectrum of vital system characteristics,
including dynamics of EV, limited EV battery size, EV battery degradation cost,
and the cost of using external energy sources for the aggregator. The algorithm
operates in real time and does not require any prior knowledge of the
statistical information of the system. Theoretically, we demonstrate that WMRA
is away from the optimum by O(1/V), where V is a controlling parameter
depending on EV's battery size. In addition, our simulation results indicate
that WMRA can substantially outperform a suboptimal greedy algorithm.