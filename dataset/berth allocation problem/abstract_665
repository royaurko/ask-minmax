This paper addresses a weighted sum rate (WSR) maximization problem for
downlink OFDMA aided by a decode-and-forward (DF) relay under a total power
constraint. A novel subcarrier-pair based opportunistic DF relaying protocol is
proposed. Specifically, user message bits are transmitted in two time slots. A
subcarrier in the first slot can be paired with a subcarrier in the second slot
for the DF relay-aided transmission to a user. In particular, the source and
the relay can transmit simultaneously to implement beamforming at the
subcarrier in the second slot. Each unpaired subcarrier in either the first or
second slot is used for the source's direct transmission to a user. A benchmark
protocol, same as the proposed one except that the transmit beamforming is not
used for the relay-aided transmission, is also considered. For each protocol, a
polynomial-complexity algorithm is developed to find at least an approximately
optimum resource allocation (RA), by using continuous relaxation, the dual
method, and Hungarian algorithm. Instrumental to the algorithm design is an
elegant definition of optimization variables, motivated by the idea of
regarding the unpaired subcarriers as virtual subcarrier pairs in the direct
transmission mode. The effectiveness of the RA algorithm and the impact of
relay position and total power on the protocols' performance are illustrated by
numerical experiments. The proposed protocol always leads to a maximum WSR
equal to or greater than that for the benchmark one, and the performance gain
of using the proposed one is significant especially when the relay is in close
proximity to the source and the total power is low. Theoretical analysis is
presented to interpret these observations.