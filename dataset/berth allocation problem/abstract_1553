A Wireless Energy Harvesting Node (WEHN) operating in linear vector Gaussian
channels with arbitrarily distributed input symbols is considered in this
paper. The precoding strategy that maximizes the mutual information along N
independent channel accesses is studied under non-causal knowledge of the
channel state and harvested energy (commonly known as offline approach). It is
shown that, at each channel use, the left singular vectors of the precoder are
equal to the eigenvectors of the Gram channel matrix. Additionally, an
expression that relates the optimal singular values of the precoder with the
energy harvesting profile through the Minimum Mean-Square Error (MMSE) matrix
is obtained. Then, the specific situation in which the right singular vectors
of the precoder are set to the identity matrix is considered. In this scenario,
the optimal offline power allocation, named Mercury Water-Flowing, is derived
and an intuitive graphical representation is presented. Two optimal offline
algorithms to compute the Mercury Water- Flowing solution are proposed and an
exhaustive study of their computational complexity is performed. Moreover, an
online algorithm is designed, which only uses causal knowledge of the harvested
energy and channel state. Finally, the achieved mutual information is evaluated
through simulation.